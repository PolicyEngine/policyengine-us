- name: RI exemption reform - restrict to children under 18
  period: 2025
  reforms: policyengine_us.reforms.states.ri.exemption.ri_exemption_reform.ri_exemption_reform
  input:
    gov.contrib.states.ri.dependent_exemption.in_effect: true
    gov.contrib.states.ri.dependent_exemption.amount: 5_100
    gov.contrib.states.ri.dependent_exemption.age_limit.in_effect: true
    gov.contrib.states.ri.dependent_exemption.age_limit.threshold: 18
    people:
      parent:
        age: 40
        employment_income: 60_000
      child1:
        age: 16
        is_tax_unit_dependent: true
      child2:
        age: 20
        is_tax_unit_dependent: true
    tax_units:
      tax_unit:
        members: [parent, child1, child2]
        filing_status: SINGLE
    households:
      household:
        members: [parent, child1, child2]
        state_name: RI
  output:
    ri_exemptions: 10_150  # 1 personal (5_050) + 1 dependent (5_100)

- name: RI exemption reform - restrict to children under 13
  period: 2025
  reforms: policyengine_us.reforms.states.ri.exemption.ri_exemption_reform.ri_exemption_reform
  input:
    gov.contrib.states.ri.dependent_exemption.in_effect: true
    gov.contrib.states.ri.dependent_exemption.amount: 5_100
    gov.contrib.states.ri.dependent_exemption.age_limit.in_effect: true
    gov.contrib.states.ri.dependent_exemption.age_limit.threshold: 13
    people:
      parent:
        age: 40
        employment_income: 60_000
      child1:
        age: 10
        is_tax_unit_dependent: true
      child2:
        age: 16
        is_tax_unit_dependent: true
    tax_units:
      tax_unit:
        members: [parent, child1, child2]
        filing_status: SINGLE
    households:
      household:
        members: [parent, child1, child2]
        state_name: RI
  output:
    ri_exemptions: 10_150  # 1 personal (5_050) + 1 dependent (5_100)

- name: RI exemption reform - AGI phaseout
  period: 2025
  reforms: policyengine_us.reforms.states.ri.exemption.ri_exemption_reform.ri_exemption_reform
  input:
    gov.contrib.states.ri.dependent_exemption.in_effect: true
    gov.contrib.states.ri.dependent_exemption.amount: 5_100
    gov.contrib.states.ri.dependent_exemption.phaseout.threshold.SINGLE: 100_000
    gov.contrib.states.ri.dependent_exemption.phaseout.rate: 0.05
    gov.contrib.states.ri.dependent_exemption.phaseout.use_earnings_phaseout: false  # Use AGI (default)
    people:
      parent:
        age: 40
        employment_income: 120_000
      child1:
        age: 10
        is_tax_unit_dependent: true
    tax_units:
      tax_unit:
        members: [parent, child1]
        filing_status: SINGLE
    households:
      household:
        members: [parent, child1]
        state_name: RI
  output:
    # Personal exemption: 5_050 (baseline)
    # Dependent exemption before phaseout: 5_100
    # Phaseout: (120_000 - 100_000) * 0.05 = 1_000 (only applies to dependent exemption)
    # Dependent exemption after phaseout: 5_100 - 1_000 = 4_100
    # Final: 5_050 (personal) + 4_100 (dependent) = 9_150
    ri_exemptions: 9_150

- name: RI exemption reform - earnings phaseout
  period: 2025
  reforms: policyengine_us.reforms.states.ri.exemption.ri_exemption_reform.ri_exemption_reform
  input:
    gov.contrib.states.ri.dependent_exemption.in_effect: true
    gov.contrib.states.ri.dependent_exemption.amount: 5_100
    gov.contrib.states.ri.dependent_exemption.phaseout.threshold.SINGLE: 100_000
    gov.contrib.states.ri.dependent_exemption.phaseout.rate: 0.05
    gov.contrib.states.ri.dependent_exemption.phaseout.use_earnings_phaseout: true  # Use earnings instead of AGI
    people:
      parent:
        age: 40
        employment_income: 30_000
      child1:
        age: 10
        is_tax_unit_dependent: true
    tax_units:
      tax_unit:
        members: [parent, child1]
        filing_status: SINGLE
    households:
      household:
        members: [parent, child1]
        state_name: RI
  output:
    # Personal exemption: 5_050 (baseline)
    # Dependent exemption: 5_100
    # No phaseout since earnings (30_000) < threshold (100_000)
    # Final: 5_050 + 5_100 = 10_150
    ri_exemptions: 10_150
