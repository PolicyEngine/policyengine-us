# Comprehensive tests for school meal daily subsidy by state group
# Tests for Alaska (AK) and Hawaii (HI) state groups with 2024 and 2025 parameter values

# Alaska 2024 tests (uses 2023-07-01 rates active on Jan 1, 2024)
- name: Alaska - 2024 PAID tier (uses 2023 rates - NSLP $0.66 + SBP $0.58)
  period: 2024
  input:
    people:
      person:
        age: 8
        is_in_k12_school: true
    spm_units:
      spm_unit:
        members: [person]
        school_meal_tier: PAID
    households:
      household:
        members: [person]
        state_code: AK
  output:
    school_meal_daily_subsidy: 1.24  # 0.66 + 0.58 (2023-07-01 rates)

- name: Alaska - 2024 REDUCED tier (uses 2023 rates - NSLP $6.50 + SBP $3.36)
  period: 2024
  input:
    people:
      parent: {}
      child:
        age: 10
        is_in_k12_school: true
    spm_units:
      spm_unit:
        members: [parent, child]
        school_meal_tier: REDUCED
    households:
      household:
        members: [parent, child]
        state_code: AK
  output:
    school_meal_daily_subsidy: 9.86  # 6.50 + 3.36 (2023-07-01 rates)

- name: Alaska - 2024 FREE tier (uses 2023 rates - NSLP $6.90 + SBP $3.66)
  period: 2024
  input:
    people:
      parent: {}
      child1:
        age: 7
        is_in_k12_school: true
      child2:
        age: 12
        is_in_k12_school: true
    spm_units:
      spm_unit:
        members: [parent, child1, child2]
        school_meal_tier: FREE
    households:
      household:
        members: [parent, child1, child2]
        state_code: AK
  output:
    school_meal_daily_subsidy: 10.56  # 6.90 + 3.66 (2023-07-01 rates)

# Alaska 2025 tests
- name: Alaska - 2025 PAID tier (NSLP $0.71 + SBP $0.62)
  period: 2025
  input:
    people:
      person:
        age: 9
        is_in_k12_school: true
    spm_units:
      spm_unit:
        members: [person]
        school_meal_tier: PAID
    households:
      household:
        members: [person]
        state_code: AK
  output:
    school_meal_daily_subsidy: 1.33  # 0.71 + 0.62

- name: Alaska - 2025 REDUCED tier (NSLP $7.05 + SBP $3.65)
  period: 2025
  input:
    people:
      parent1: {}
      parent2: {}
      child:
        age: 11
        is_in_k12_school: true
    spm_units:
      spm_unit:
        members: [parent1, parent2, child]
        school_meal_tier: REDUCED
    households:
      household:
        members: [parent1, parent2, child]
        state_code: AK
  output:
    school_meal_daily_subsidy: 10.70  # 7.05 + 3.65

- name: Alaska - 2025 FREE tier (NSLP $7.45 + SBP $3.95)
  period: 2025
  input:
    people:
      parent: {}
      child:
        age: 6
        is_in_k12_school: true
    spm_units:
      spm_unit:
        members: [parent, child]
        school_meal_tier: FREE
    households:
      household:
        members: [parent, child]
        state_code: AK
  output:
    school_meal_daily_subsidy: 11.40  # 7.45 + 3.95

# Hawaii 2024 tests (uses 2023-07-01 rates active on Jan 1, 2024)
- name: Hawaii - 2024 PAID tier (uses 2023 rates - NSLP $0.53 + SBP $0.47)
  period: 2024
  input:
    people:
      person:
        age: 8
        is_in_k12_school: true
    spm_units:
      spm_unit:
        members: [person]
        school_meal_tier: PAID
    households:
      household:
        members: [person]
        state_code: HI
  output:
    school_meal_daily_subsidy: 1.00  # 0.53 + 0.47 (2023-07-01 rates)

- name: Hawaii - 2024 REDUCED tier (uses 2023 rates - NSLP $5.14 + SBP $2.65)
  period: 2024
  input:
    people:
      parent: {}
      child:
        age: 10
        is_in_k12_school: true
    spm_units:
      spm_unit:
        members: [parent, child]
        school_meal_tier: REDUCED
    households:
      household:
        members: [parent, child]
        state_code: HI
  output:
    school_meal_daily_subsidy: 7.79  # 5.14 + 2.65 (2023-07-01 rates)

- name: Hawaii - 2024 FREE tier (uses 2023 rates - NSLP $5.54 + SBP $2.95)
  period: 2024
  input:
    people:
      parent: {}
      child1:
        age: 7
        is_in_k12_school: true
      child2:
        age: 12
        is_in_k12_school: true
    spm_units:
      spm_unit:
        members: [parent, child1, child2]
        school_meal_tier: FREE
    households:
      household:
        members: [parent, child1, child2]
        state_code: HI
  output:
    school_meal_daily_subsidy: 8.49  # 5.54 + 2.95 (2023-07-01 rates)

# Hawaii 2025 tests
- name: Hawaii - 2025 PAID tier (NSLP $0.57 + SBP $0.51)
  period: 2025
  input:
    people:
      person:
        age: 9
        is_in_k12_school: true
    spm_units:
      spm_unit:
        members: [person]
        school_meal_tier: PAID
    households:
      household:
        members: [person]
        state_code: HI
  output:
    school_meal_daily_subsidy: 1.08  # 0.57 + 0.51

- name: Hawaii - 2025 REDUCED tier (NSLP $5.58 + SBP $2.88)
  period: 2025
  input:
    people:
      parent1: {}
      parent2: {}
      child:
        age: 11
        is_in_k12_school: true
    spm_units:
      spm_unit:
        members: [parent1, parent2, child]
        school_meal_tier: REDUCED
    households:
      household:
        members: [parent1, parent2, child]
        state_code: HI
  output:
    school_meal_daily_subsidy: 8.46  # 5.58 + 2.88

- name: Hawaii - 2025 FREE tier (NSLP $5.98 + SBP $3.18)
  period: 2025
  input:
    people:
      parent: {}
      child:
        age: 6
        is_in_k12_school: true
    spm_units:
      spm_unit:
        members: [parent, child]
        school_meal_tier: FREE
    households:
      household:
        members: [parent, child]
        state_code: HI
  output:
    school_meal_daily_subsidy: 9.16  # 5.98 + 3.18

# Test state group boundary cases - ensure states not in AK or HI use CONTIGUOUS_US
- name: California uses CONTIGUOUS_US rates - 2024 FREE tier
  period: 2024
  input:
    people:
      person:
        age: 10
        is_in_k12_school: true
    spm_units:
      spm_unit:
        members: [person]
        school_meal_tier: FREE
    households:
      household:
        members: [person]
        state_code: CA
  output:
    school_meal_daily_subsidy: 6.53  # 4.25 + 2.28 (2023-07-01 CONTIGUOUS_US rates)

- name: New York uses CONTIGUOUS_US rates - 2025 REDUCED tier
  period: 2025
  input:
    people:
      person:
        age: 12
        is_in_k12_school: true
    spm_units:
      spm_unit:
        members: [person]
        school_meal_tier: REDUCED
    households:
      household:
        members: [person]
        state_code: NY
  output:
    school_meal_daily_subsidy: 6.36  # 4.20 + 2.16 (CONTIGUOUS_US rates)

# Test edge case: Verify values for 2023, 2024 and 2025
- name: Contiguous US - 2023 rates for FREE tier
  period: 2023
  input:
    people:
      person:
        age: 10
        is_in_k12_school: true
    spm_units:
      spm_unit:
        members: [person]
        school_meal_tier: FREE
    households:
      household:
        members: [person]
        state_code: TX
  output:
    school_meal_daily_subsidy: 6.04  # 3.93 + 2.11 (2022-07-01 rates active on Jan 1, 2023)

- name: Contiguous US - 2024 rates for FREE tier
  period: 2024
  input:
    people:
      person:
        age: 10
        is_in_k12_school: true
    spm_units:
      spm_unit:
        members: [person]
        school_meal_tier: FREE
    households:
      household:
        members: [person]
        state_code: TX
  output:
    school_meal_daily_subsidy: 6.53  # 4.25 + 2.28 (2023-07-01 rates active on Jan 1, 2024)

# Test edge case: Test different tier values
- name: Contiguous US - 2024 rates for REDUCED tier
  period: 2024
  input:
    people:
      person:
        age: 11
        is_in_k12_school: true
    spm_units:
      spm_unit:
        members: [person]
        school_meal_tier: REDUCED
    households:
      household:
        members: [person]
        state_code: FL
  output:
    school_meal_daily_subsidy: 5.83  # 3.85 + 1.98 (2023 rates, active on Jan 1 2024)

- name: Contiguous US - 2025 rates for REDUCED tier
  period: 2025
  input:
    people:
      person:
        age: 11
        is_in_k12_school: true
    spm_units:
      spm_unit:
        members: [person]
        school_meal_tier: REDUCED
    households:
      household:
        members: [person]
        state_code: FL
  output:
    school_meal_daily_subsidy: 6.36  # 4.20 + 2.16 (2025 rates)
