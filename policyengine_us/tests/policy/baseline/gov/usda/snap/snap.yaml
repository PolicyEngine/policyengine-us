- name: Total SNAP sums normal and emergency allotments.
  period: 2022
  input:
    snap_normal_allotment: 1
    snap_emergency_allotment: 
      2022-01: 2
      2022-02: 0
      2022-03: 0
      2022-04: 0
      2022-05: 0
      2022-06: 0
      2022-07: 0
      2022-08: 0
      2022-09: 0
      2022-10: 0
      2022-11: 0
      2022-12: 0
  output:
    snap: 3

- name: Total SNAP sums normal and emergency allotments in 2024 with DC temporary local benefit.
  period: 2024
  input:
    snap_normal_allotment: 1
    snap_emergency_allotment: 
      2024-01: 2
      2024-02: 0
      2024-03: 0
      2024-04: 0
      2024-05: 0
      2024-06: 0
      2024-07: 0
      2024-08: 0
      2024-09: 0
      2024-10: 0
      2024-11: 0
      2024-12: 0
    dc_snap_temporary_local_benefit: 3 
  output:
    snap: 6

- name: North Carolina 2025, yearly integration test
  period: 2025
  absolute_error_margin: 0.01
  input:
    people:   
      person1:
        age: 55
        is_blind: true
        employment_income: 30_600
    households:
      household:
        members: [person1]
        state_code: NC
  output:
  # only eligible in the last three months of the year
  # due to higher federal poverty guidelines
    snap_self_employment_income_after_expense_deduction: 0
    snap_self_employment_expense_deduction: 0
    snap: 71.75 

- name: Self-employment income deduction integration test
  period: 2025
  absolute_error_margin: 1
  input:
    people:   
      person1:
        age: 55
        self_employment_income: 10_000
    households:
      household:
        members: [person1]
        state_code: OH
    spm_units:
      spm_unit:
        members: [person1]
        snap_standard_deduction: 0
        snap_earned_income_deduction: 0
  output:
    snap_self_employment_income_after_expense_deduction: 5_000
    snap_self_employment_expense_deduction: 5_000
    # The self-employment income deduction is applied to gross income 
    # and not in the list of deductions.
    # This also allows for proper earned income deduction calculation.
    snap_deductions: 0
    snap_earned_income: 5_000
    snap_gross_income: 5_000
    snap_net_income: 5_000
    snap: 2_028

- name: Counterfactual test, self-employment income deduction allowed
  period: 2025
  absolute_error_margin: 1
  input:
    gov.usda.snap.income.deductions.allowed: [snap_standard_deduction, snap_earned_income_deduction, snap_dependent_care_deduction, snap_child_support_deduction, snap_excess_medical_expense_deduction, snap_excess_shelter_expense_deduction, snap_self_employment_expense_deduction]
    people:   
      person1:
        age: 55
        self_employment_income: 10_000
    households:
      household:
        members: [person1]
        state_code: OH
    spm_units:
      spm_unit:
        members: [person1]
        snap_standard_deduction: 0
        snap_earned_income_deduction: 0
  output:
    snap_self_employment_income_after_expense_deduction: 5_000
    snap_self_employment_expense_deduction: 5_000
    # In the counterfactual, the self-employment income deduction is first applied to earned income.
    snap_gross_income: 5_000
    snap_earned_income: 5_000
    snap_deductions: 5_000
    # And then again subtracted as a deduction from gross income.
    snap_net_income: 0
    snap: 3_525
