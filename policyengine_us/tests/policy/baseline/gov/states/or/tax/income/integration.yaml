- name: Zero employment income.
  period: 2021
  input:
    employment_income: 0
    state_code: OR
  output:
    or_income_tax: 0

- name: Elderly OR couple with modest pension, social security, and bond income
  absolute_error_margin: 0.01
  period: 2021
  input:
    people:
      person1:
        is_tax_unit_head: true
        age: 67
        taxable_interest_income: 9000.0
        taxable_pension_income: 5000.0
        social_security: 1000.0
      person2:
        is_tax_unit_spouse: true
        age: 67
        taxable_interest_income: 9000.0
        taxable_pension_income: 5000.0
        social_security: 1000.0
    tax_units:
      tax_unit:
        members: [person1, person2]
        aca_ptc: 0
    households:
      household:
        members: [person1, person2]
        state_code: OR
  output:
    or_income_tax_before_credits: 1349.75
    or_exemption_credit: 426.00
    or_retirement_credit: 900.00
    or_income_tax: 23.75  # = 1349.75 - 426.00 - 900.00

- name: Tax unit with taxsimid 99570 in j21.its.csv and j21.ots.csv
  absolute_error_margin: 0.1
  period: 2021
  input:
    people:
      person1:
        age: 71
        employment_income: 1_010
        qualified_dividend_income: 8_010
        taxable_interest_income: 11_010
        short_term_capital_gains: 2_010
        long_term_capital_gains: 1_010
        rental_income: 3_010
        taxable_private_pension_income: 5000
        social_security_retirement: 13_000
        rent: 21_000
        self_employment_income: 117_010
        business_is_qualified: true
        business_is_sstb: false
        w2_wages_from_qualified_business: 100e6
      person2:
        age: 11
      person3:
        age: 11
      person4:
        age: 16
    tax_units:
      tax_unit:
        members: [person1, person2, person3, person4]
        tax_unit_itemizes: False
        state_income_tax: 10_431.06
    households:
      household:
        members: [person1, person2, person3, person4]
        state_fips: 41  # OR
  output:  # expected results from patched TAXSIM35 2024-02-02 version
    # or_agi: 139_803.51
    or_standard_deduction: 4_980.00
    or_itemized_deductions: 0
    or_taxable_income: 127_773.51
    or_income_tax: 9_814.18

- name: 40839-OR.yaml
  absolute_error_margin: 0.1
  period: 2024
  input:
    people:
      person1:
        age: 70
        employment_income: 1
        ssi: 0
        wic: 0
        deductible_mortgage_interest: 0
        taxable_interest_income: 4_000
        taxable_pension_income: 18_010
    tax_units:
      tax_unit:
        members: [person1]
        tax_unit_childcare_expenses: 0
        premium_tax_credit: 0
        local_income_tax: 0
        state_sales_tax: 0
    spm_units:
      spm_unit:
        members: [person1]
        snap: 0
        tanf: 0
    households:
      household:
        members: [person1]
        state_fips: 41
  output:
    # Tax calculation with corrected 2024 brackets:
    # OR AGI: $21,464.90 (Federal AGI $22,011 - federal tax subtraction $546.10)
    # Standard deduction: $3,945 ($2,745 base + $1,200 elderly addition)
    # Taxable income: $17,519.90
    # Tax: $4,300 @ 4.75% + $6,450 @ 6.75% + $6,769.90 @ 8.75% = $1,231.99
    # Credits: Exemption $249 + Retirement $44.01 = $293.01
    # Final tax: $1,231.99 - $293.01 = $938.98
    or_retirement_credit: 44
    or_income_tax: 939

# 2025 integration test
- name: 2025 single filer with employment income
  absolute_error_margin: 1
  period: 2025
  input:
    people:
      person1:
        age: 35
        employment_income: 50_000
    tax_units:
      tax_unit:
        members: [person1]
    households:
      household:
        members: [person1]
        state_code: OR
  output:
    # Federal AGI: $50,000
    # OR AGI: $46,128.50 (after federal tax subtraction of $3,871.50)
    # Standard deduction: $2,835 (single 2025)
    # Taxable income: $43,293.50
    # Tax calculation (2025 corrected brackets: $0, $4,400, $11,100):
    #   - First $4,400 at 4.75% = $209.00
    #   - $4,400 to $11,100 ($6,700) at 6.75% = $452.25
    #   - Above $11,100 ($32,193.50) at 8.75% = $2,816.93
    # Total before credits: $3,478.18
    # Exemption credit: $256 (1 exemption)
    # Tax after credits: $3,222.18
    or_standard_deduction: 2_835
    or_exemption_credit: 256

- name: 2025 joint filers with child eligible for CTC
  absolute_error_margin: 1
  period: 2025
  input:
    people:
      parent1:
        age: 35
        employment_income: 13_000
      parent2:
        age: 33
        employment_income: 12_000
      child:
        age: 4
    tax_units:
      tax_unit:
        members: [parent1, parent2, child]
    households:
      household:
        members: [parent1, parent2, child]
        state_code: OR
  output:
    # Joint filing with $25,000 combined income (Oregon AGI)
    # Standard deduction: $5,670 (joint 2025)
    # Exemption credit: $256 * 3 = $768
    # OR CTC: $1,050 (full amount, AGI $25,000 is under phase-out start of $26,550)
    or_standard_deduction: 5_670
    or_exemption_credit: 768
    or_ctc: 1_050
