# Integration tests for Illinois Senior Citizens Real Estate Tax Deferral Program
# Tests full eligibility and benefit calculation pipeline
# Source: 320 ILCS 30/1 et seq., PIO-64

- name: Eligible senior with low income in 2024.
  period: 2024
  input:
    people:
      person1:
        age: 70
        employment_income: 50_000
        real_estate_taxes: 10_000
    tax_units:
      tax_unit:
        members: [person1]
    households:
      household:
        members: [person1]
        state_code: IL
  output:
    il_scretd_age_eligible: true
    il_scretd_income_eligible: true
    il_scretd_eligible: true
    # Deferral = min(10,000, 7,500) = 7,500
    il_scretd_deferral_amount: 7_500

- name: Ineligible due to age in 2024.
  period: 2024
  input:
    people:
      person1:
        age: 60
        employment_income: 50_000
        real_estate_taxes: 10_000
    tax_units:
      tax_unit:
        members: [person1]
    households:
      household:
        members: [person1]
        state_code: IL
  output:
    il_scretd_age_eligible: false
    il_scretd_income_eligible: true
    il_scretd_eligible: false
    il_scretd_deferral_amount: 0

- name: Ineligible due to income in 2024.
  period: 2024
  input:
    people:
      person1:
        age: 70
        employment_income: 80_000
        real_estate_taxes: 10_000
    tax_units:
      tax_unit:
        members: [person1]
    households:
      household:
        members: [person1]
        state_code: IL
  output:
    il_scretd_age_eligible: true
    il_scretd_income_eligible: false
    il_scretd_eligible: false
    il_scretd_deferral_amount: 0

- name: Eligible senior at 2025 income limit.
  period: 2025
  input:
    people:
      person1:
        age: 65
        employment_income: 75_000
        real_estate_taxes: 10_000
    tax_units:
      tax_unit:
        members: [person1]
    households:
      household:
        members: [person1]
        state_code: IL
  output:
    il_scretd_age_eligible: true
    il_scretd_income_eligible: true
    il_scretd_eligible: true
    il_scretd_deferral_amount: 7_500

- name: Ineligible just over 2025 income limit.
  period: 2025
  input:
    people:
      person1:
        age: 68
        employment_income: 76_000
        real_estate_taxes: 10_000
    tax_units:
      tax_unit:
        members: [person1]
    households:
      household:
        members: [person1]
        state_code: IL
  output:
    il_scretd_age_eligible: true
    il_scretd_income_eligible: false
    il_scretd_eligible: false
    il_scretd_deferral_amount: 0

- name: Eligible senior with 2027 income limit.
  period: 2027
  input:
    people:
      person1:
        age: 72
        employment_income: 79_000
        real_estate_taxes: 10_000
    tax_units:
      tax_unit:
        members: [person1]
    households:
      household:
        members: [person1]
        state_code: IL
  output:
    il_scretd_age_eligible: true
    il_scretd_income_eligible: true
    il_scretd_eligible: true
    il_scretd_deferral_amount: 7_500

- name: Ineligible just over 2027 income limit.
  period: 2027
  input:
    people:
      person1:
        age: 75
        employment_income: 80_000
        real_estate_taxes: 10_000
    tax_units:
      tax_unit:
        members: [person1]
    households:
      household:
        members: [person1]
        state_code: IL
  output:
    il_scretd_age_eligible: true
    il_scretd_income_eligible: false
    il_scretd_eligible: false
    il_scretd_deferral_amount: 0

# Multi-person household tests

- name: Couple where one is 65 and one is 64.
  period: 2024
  input:
    people:
      person1:
        age: 65
        employment_income: 30_000
        real_estate_taxes: 10_000
      person2:
        age: 64
        employment_income: 20_000
    tax_units:
      tax_unit:
        members: [person1, person2]
    households:
      household:
        members: [person1, person2]
        state_code: IL
  output:
    il_scretd_age_eligible: [true, false]
    il_scretd_income_eligible: true
    il_scretd_eligible: true
    il_scretd_deferral_amount: 7_500

- name: Couple where both are under 65.
  period: 2024
  input:
    people:
      person1:
        age: 64
        employment_income: 30_000
        real_estate_taxes: 10_000
      person2:
        age: 62
        employment_income: 20_000
    tax_units:
      tax_unit:
        members: [person1, person2]
    households:
      household:
        members: [person1, person2]
        state_code: IL
  output:
    il_scretd_age_eligible: [false, false]
    il_scretd_income_eligible: true
    il_scretd_eligible: false
    il_scretd_deferral_amount: 0

- name: Couple with age-eligible member but income too high.
  period: 2024
  input:
    people:
      person1:
        age: 70
        employment_income: 40_000
        real_estate_taxes: 10_000
      person2:
        age: 68
        employment_income: 30_000
    tax_units:
      tax_unit:
        members: [person1, person2]
    households:
      household:
        members: [person1, person2]
        state_code: IL
  output:
    il_scretd_age_eligible: [true, true]
    il_scretd_income_eligible: false
    il_scretd_eligible: false
    il_scretd_deferral_amount: 0

- name: Eligible with property taxes below cap.
  period: 2024
  input:
    people:
      person1:
        age: 65
        employment_income: 50_000
        real_estate_taxes: 5_000
    tax_units:
      tax_unit:
        members: [person1]
    households:
      household:
        members: [person1]
        state_code: IL
  output:
    il_scretd_age_eligible: true
    il_scretd_income_eligible: true
    il_scretd_eligible: true
    # Deferral = min(5,000, 7,500) = 5,000
    il_scretd_deferral_amount: 5_000
