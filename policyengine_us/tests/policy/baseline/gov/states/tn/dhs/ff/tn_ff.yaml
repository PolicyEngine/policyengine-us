# Tests for TN Families First benefit calculation
# For 2021+:
# - CNS size 2: $1,370, SPA: $343
# - Earned income disregard: $250
# - Child care (age 2+): $175
# - Minimum grant: $10
# - Fill-the-gap: benefit = min(payment_standard, CNS - countable_income)
# Note: Basic scenarios (no income, no child) tested in integration.yaml

- name: Case 1, earned income with child care.
  period: 2024-01
  input:
    people:
      person1:
        age: 30
        tanf_gross_earned_income: 900
      person2:
        age: 5
        is_tax_unit_dependent: true
    spm_units:
      spm_unit:
        members: [person1, person2]
        childcare_expenses: 6_000  # $500/month * 12
    households:
      household:
        members: [person1, person2]
        state_code: TN
  output:
    # Countable: $900 - $250 - $175 = $475
    # Deficit: $1,370 - $475 = $895
    # Benefit: min($343, $895) = $343
    tn_ff: 343

- name: Case 2, moderate income still gets full SPA.
  period: 2024-01
  input:
    people:
      person1:
        age: 30
        tanf_gross_earned_income: 1_200
      person2:
        age: 5
        is_tax_unit_dependent: true
    spm_units:
      spm_unit:
        members: [person1, person2]
        childcare_expenses: 6_000  # $500/month * 12
    households:
      household:
        members: [person1, person2]
        state_code: TN
  output:
    # Countable: $1,200 - $250 - $175 = $775
    # Deficit: $1,370 - $775 = $595
    # Benefit: min($343, $595) = $343
    tn_ff: 343

- name: Case 3, high income results in deficit below SPA.
  period: 2024-01
  input:
    people:
      person1:
        age: 30
        tanf_gross_earned_income: 1_500
      person2:
        age: 5
        is_tax_unit_dependent: true
    spm_units:
      spm_unit:
        members: [person1, person2]
        childcare_expenses: 6_000  # $500/month * 12
    households:
      household:
        members: [person1, person2]
        state_code: TN
  output:
    # Countable: $1,500 - $250 - $175 = $1,075
    # Deficit: $1,370 - $1,075 = $295
    # Benefit: min($343, $295) = $295
    tn_ff: 295

- name: Case 4, income near CNS gives small benefit.
  period: 2024-01
  input:
    people:
      person1:
        age: 30
        tanf_gross_earned_income: 1_720
      person2:
        age: 5
        is_tax_unit_dependent: true
    spm_units:
      spm_unit:
        members: [person1, person2]
        childcare_expenses: 6_000  # $500/month * 12
    households:
      household:
        members: [person1, person2]
        state_code: TN
  output:
    # Countable: $1,720 - $250 - $175 = $1,295
    # Deficit: $1,370 - $1,295 = $75
    # Benefit: min($343, $75) = $75 >= $10 minimum
    tn_ff: 75

- name: Case 5, benefit exactly at minimum grant.
  period: 2024-01
  input:
    people:
      person1:
        age: 30
        tanf_gross_earned_income: 1_785
      person2:
        age: 5
        is_tax_unit_dependent: true
    spm_units:
      spm_unit:
        members: [person1, person2]
        childcare_expenses: 6_000  # $500/month * 12
    households:
      household:
        members: [person1, person2]
        state_code: TN
  output:
    # Countable: $1,785 - $250 - $175 = $1,360
    # Deficit: $1,370 - $1,360 = $10
    # Benefit: min($343, $10) = $10 >= $10 minimum
    tn_ff: 10

- name: Case 6, benefit below minimum grant is zero.
  period: 2024-01
  input:
    people:
      person1:
        age: 30
        tanf_gross_earned_income: 1_786
      person2:
        age: 5
        is_tax_unit_dependent: true
    spm_units:
      spm_unit:
        members: [person1, person2]
        childcare_expenses: 6_000  # $500/month * 12
    households:
      household:
        members: [person1, person2]
        state_code: TN
  output:
    # Countable: $1,786 - $250 - $175 = $1,361
    # Deficit: $1,370 - $1,361 = $9
    # Benefit: $9 < $10 minimum â†’ $0
    tn_ff: 0
