# Integration tests for WA TANF using Aug 2024+ rules
# ($500 flat disregard + 50%, $12,000 resource limit, Aug 2024 income limits)

- name: Case 1, single parent with 2 children, no income.
  period: 2025-01
  input:
    people:
      person1:
        age: 30
      person2:
        age: 5
        is_tax_unit_dependent: true
      person3:
        age: 3
        is_tax_unit_dependent: true
    families:
      family:
        members: [person1, person2, person3]
    spm_units:
      spm_unit:
        members: [person1, person2, person3]
    tax_units:
      tax_unit:
        members: [person1, person2, person3]
    households:
      household:
        members: [person1, person2, person3]
        state_code: WA
  output:
    wa_tanf_payment_standard: 706
    wa_tanf_countable_income: 0
    wa_tanf_eligible: true
    wa_tanf: 706

- name: Case 2, single parent with 2 children, low earned income.
  period: 2025-01
  input:
    people:
      person1:
        age: 30
        employment_income_before_lsr: 12_000
      person2:
        age: 5
        is_tax_unit_dependent: true
      person3:
        age: 3
        is_tax_unit_dependent: true
    families:
      family:
        members: [person1, person2, person3]
    spm_units:
      spm_unit:
        members: [person1, person2, person3]
    tax_units:
      tax_unit:
        members: [person1, person2, person3]
    households:
      household:
        members: [person1, person2, person3]
        state_code: WA
  output:
    wa_tanf_payment_standard: 706
    # Monthly income: $12,000 / 12 = $1,000
    # Countable earned = max($1,000 - $500, 0) × 0.5 = $250
    wa_tanf_countable_income: 250
    wa_tanf_eligible: true
    wa_tanf: 456

- name: Case 3, single parent with 2 children, moderate earned income.
  period: 2025-01
  input:
    people:
      person1:
        age: 30
        employment_income_before_lsr: 22_944
      person2:
        age: 5
        is_tax_unit_dependent: true
      person3:
        age: 3
        is_tax_unit_dependent: true
    families:
      family:
        members: [person1, person2, person3]
    spm_units:
      spm_unit:
        members: [person1, person2, person3]
    tax_units:
      tax_unit:
        members: [person1, person2, person3]
    households:
      household:
        members: [person1, person2, person3]
        state_code: WA
  output:
    wa_tanf_payment_standard: 706
    # Monthly income: $22,944 / 12 = $1,912 (at income limit)
    # Countable earned = max($1,912 - $500, 0) × 0.5 = $706
    wa_tanf_countable_income: 706
    wa_tanf_eligible: true
    wa_tanf: 0

- name: Case 4, two parents with 3 children, one parent working.
  period: 2025-01
  input:
    people:
      person1:
        age: 32
        employment_income_before_lsr: 18_000
      person2:
        age: 30
      person3:
        age: 8
        is_tax_unit_dependent: true
      person4:
        age: 5
        is_tax_unit_dependent: true
      person5:
        age: 2
        is_tax_unit_dependent: true
    families:
      family:
        members: [person1, person2, person3, person4, person5]
    spm_units:
      spm_unit:
        members: [person1, person2, person3, person4, person5]
    tax_units:
      tax_unit:
        members: [person1, person2, person3, person4, person5]
    households:
      household:
        members: [person1, person2, person3, person4, person5]
        state_code: WA
  output:
    wa_tanf_payment_standard: 959
    # Monthly income: $18,000 / 12 = $1,500
    # Countable earned = max($1,500 - $500, 0) × 0.5 = $500
    wa_tanf_countable_income: 500
    wa_tanf_eligible: true
    wa_tanf: 459

- name: Case 5, single parent with 1 child, unearned income only.
  period: 2025-01
  input:
    people:
      person1:
        age: 45
        social_security: 6_000
      person2:
        age: 10
        is_tax_unit_dependent: true
    families:
      family:
        members: [person1, person2]
    spm_units:
      spm_unit:
        members: [person1, person2]
    tax_units:
      tax_unit:
        members: [person1, person2]
    households:
      household:
        members: [person1, person2]
        state_code: WA
  output:
    wa_tanf_payment_standard: 570
    # Monthly unearned income: $6,000 / 12 = $500
    # No earned income disregard for unearned income
    wa_tanf_countable_income: 500
    wa_tanf_eligible: true
    wa_tanf: 70

- name: Case 6, family size 1, pregnant woman.
  period: 2025-01
  input:
    people:
      person1:
        age: 25
        is_pregnant: true
    families:
      family:
        members: [person1]
    spm_units:
      spm_unit:
        members: [person1]
    tax_units:
      tax_unit:
        members: [person1]
    households:
      household:
        members: [person1]
        state_code: WA
  output:
    wa_tanf_payment_standard: 450
    wa_tanf_countable_income: 0
    wa_tanf_eligible: true
    wa_tanf: 450

- name: Case 7, family of 7, no income.
  period: 2025-01
  input:
    people:
      person1:
        age: 40
      person2:
        age: 38
      person3:
        age: 15
        is_tax_unit_dependent: true
      person4:
        age: 13
        is_tax_unit_dependent: true
      person5:
        age: 11
        is_tax_unit_dependent: true
      person6:
        age: 9
        is_tax_unit_dependent: true
      person7:
        age: 7
        is_tax_unit_dependent: true
    families:
      family:
        members: [person1, person2, person3, person4, person5, person6, person7]
    spm_units:
      spm_unit:
        members: [person1, person2, person3, person4, person5, person6, person7]
    tax_units:
      tax_unit:
        members: [person1, person2, person3, person4, person5, person6, person7]
    households:
      household:
        members: [person1, person2, person3, person4, person5, person6, person7]
        state_code: WA
  output:
    wa_tanf_payment_standard: 1_258
    wa_tanf_countable_income: 0
    wa_tanf_eligible: true
    wa_tanf: 1_258

- name: Case 8, family size 10, no income.
  period: 2025-01
  input:
    people:
      person1:
        age: 45
      person2:
        age: 43
      person3:
        age: 18
      person4:
        age: 16
        is_tax_unit_dependent: true
      person5:
        age: 14
        is_tax_unit_dependent: true
      person6:
        age: 12
        is_tax_unit_dependent: true
      person7:
        age: 10
        is_tax_unit_dependent: true
      person8:
        age: 8
        is_tax_unit_dependent: true
      person9:
        age: 6
        is_tax_unit_dependent: true
      person10:
        age: 4
        is_tax_unit_dependent: true
    families:
      family:
        members: [person1, person2, person3, person4, person5, person6, person7,
          person8, person9, person10]
    spm_units:
      spm_unit:
        members: [person1, person2, person3, person4, person5, person6, person7,
          person8, person9, person10]
    tax_units:
      tax_unit:
        members: [person1, person2, person3, person4, person5, person6, person7,
          person8, person9, person10]
    households:
      household:
        members: [person1, person2, person3, person4, person5, person6, person7,
          person8, person9, person10]
        state_code: WA
  output:
    wa_tanf_payment_standard: 1_662
    wa_tanf_countable_income: 0
    wa_tanf_eligible: true
    wa_tanf: 1_662

- name: Case 9, single parent with 1 child, earned income below $500.
  period: 2025-01
  input:
    people:
      person1:
        age: 28
        employment_income_before_lsr: 4_800
      person2:
        age: 3
        is_tax_unit_dependent: true
    families:
      family:
        members: [person1, person2]
    spm_units:
      spm_unit:
        members: [person1, person2]
    tax_units:
      tax_unit:
        members: [person1, person2]
    households:
      household:
        members: [person1, person2]
        state_code: WA
  output:
    wa_tanf_payment_standard: 570
    # Monthly income: $4,800 / 12 = $400
    # Countable earned = max($400 - $500, 0) × 0.5 = $0
    wa_tanf_countable_income: 0
    wa_tanf_eligible: true
    wa_tanf: 570

- name: Case 10, single parent with 3 children, earned income exactly at $500.
  period: 2025-01
  input:
    people:
      person1:
        age: 32
        employment_income_before_lsr: 6_000
      person2:
        age: 10
        is_tax_unit_dependent: true
      person3:
        age: 7
        is_tax_unit_dependent: true
      person4:
        age: 4
        is_tax_unit_dependent: true
    families:
      family:
        members: [person1, person2, person3, person4]
    spm_units:
      spm_unit:
        members: [person1, person2, person3, person4]
    tax_units:
      tax_unit:
        members: [person1, person2, person3, person4]
    households:
      household:
        members: [person1, person2, person3, person4]
        state_code: WA
  output:
    wa_tanf_payment_standard: 833
    # Monthly income: $6,000 / 12 = $500
    # Countable earned = max($500 - $500, 0) × 0.5 = $0
    wa_tanf_countable_income: 0
    wa_tanf_eligible: true
    wa_tanf: 833

- name: Case 11, family of 5, high unearned income.
  period: 2025-01
  input:
    people:
      person1:
        age: 50
        social_security: 12_000
      person2:
        age: 15
        is_tax_unit_dependent: true
      person3:
        age: 13
        is_tax_unit_dependent: true
      person4:
        age: 11
        is_tax_unit_dependent: true
      person5:
        age: 9
        is_tax_unit_dependent: true
    families:
      family:
        members: [person1, person2, person3, person4, person5]
    spm_units:
      spm_unit:
        members: [person1, person2, person3, person4, person5]
    tax_units:
      tax_unit:
        members: [person1, person2, person3, person4, person5]
    households:
      household:
        members: [person1, person2, person3, person4, person5]
        state_code: WA
  output:
    wa_tanf_payment_standard: 959
    # Monthly unearned income: $12,000 / 12 = $1,000
    wa_tanf_countable_income: 1_000
    wa_tanf_eligible: true
    wa_tanf: 0

- name: Case 12, single parent with 4 children, self-employment income.
  period: 2025-01
  input:
    people:
      person1:
        age: 34
        self_employment_income_before_lsr: 15_600
      person2:
        age: 12
        is_tax_unit_dependent: true
      person3:
        age: 10
        is_tax_unit_dependent: true
      person4:
        age: 8
        is_tax_unit_dependent: true
      person5:
        age: 6
        is_tax_unit_dependent: true
    families:
      family:
        members: [person1, person2, person3, person4, person5]
    spm_units:
      spm_unit:
        members: [person1, person2, person3, person4, person5]
    tax_units:
      tax_unit:
        members: [person1, person2, person3, person4, person5]
    households:
      household:
        members: [person1, person2, person3, person4, person5]
        state_code: WA
  output:
    wa_tanf_payment_standard: 959
    # Monthly income: $15,600 / 12 = $1,300
    # Countable earned = max($1,300 - $500, 0) × 0.5 = $400
    wa_tanf_countable_income: 400
    wa_tanf_eligible: true
    wa_tanf: 559

# Historical integration tests for 2018-01 period
# (50% disregard only, no $500 flat deduction, $1,000 resource limit)

- name: Case 13, 2018-01 single parent with 2 children, no income.
  period: 2018-01
  input:
    people:
      person1:
        age: 30
      person2:
        age: 5
        is_tax_unit_dependent: true
      person3:
        age: 3
        is_tax_unit_dependent: true
    families:
      family:
        members: [person1, person2, person3]
    spm_units:
      spm_unit:
        members: [person1, person2, person3]
    tax_units:
      tax_unit:
        members: [person1, person2, person3]
    households:
      household:
        members: [person1, person2, person3]
        state_code: WA
  output:
    # 2016-02-01 payment standard for family of 3: $521
    wa_tanf_payment_standard: 521
    wa_tanf_countable_income: 0
    wa_tanf_eligible: true
    wa_tanf: 521

- name: Case 14, 2018-01 single parent with 2 children, low earned income.
  period: 2018-01
  input:
    people:
      person1:
        age: 30
        employment_income_before_lsr: 6_000
      person2:
        age: 5
        is_tax_unit_dependent: true
      person3:
        age: 3
        is_tax_unit_dependent: true
    families:
      family:
        members: [person1, person2, person3]
    spm_units:
      spm_unit:
        members: [person1, person2, person3]
    tax_units:
      tax_unit:
        members: [person1, person2, person3]
    households:
      household:
        members: [person1, person2, person3]
        state_code: WA
  output:
    wa_tanf_payment_standard: 521
    # Monthly income: $6,000 / 12 = $500
    # Countable earned = $500 × 0.5 = $250 (no $500 flat disregard in 2018)
    wa_tanf_countable_income: 250
    wa_tanf_eligible: true
    wa_tanf: 271

- name: Case 15, 2018-01 single parent with 2 children, income at threshold.
  period: 2018-01
  input:
    people:
      person1:
        age: 30
        employment_income_before_lsr: 12_504
      person2:
        age: 5
        is_tax_unit_dependent: true
      person3:
        age: 3
        is_tax_unit_dependent: true
    families:
      family:
        members: [person1, person2, person3]
    spm_units:
      spm_unit:
        members: [person1, person2, person3]
    tax_units:
      tax_unit:
        members: [person1, person2, person3]
    households:
      household:
        members: [person1, person2, person3]
        state_code: WA
  output:
    wa_tanf_payment_standard: 521
    # Monthly income: $12,504 / 12 = $1,042 (at income limit)
    # Countable earned = $1,042 × 0.5 = $521
    wa_tanf_countable_income: 521
    wa_tanf_eligible: true
    wa_tanf: 0

# Historical integration tests for 2024-01 period
# (50% disregard only, no $500 flat deduction, $6,000 resource limit)

- name: Case 16, 2024-01 single parent with 2 children, no income.
  period: 2024-01
  input:
    people:
      person1:
        age: 30
      person2:
        age: 5
        is_tax_unit_dependent: true
      person3:
        age: 3
        is_tax_unit_dependent: true
    families:
      family:
        members: [person1, person2, person3]
    spm_units:
      spm_unit:
        members: [person1, person2, person3]
    tax_units:
      tax_unit:
        members: [person1, person2, person3]
    households:
      household:
        members: [person1, person2, person3]
        state_code: WA
  output:
    # 2024-01-01 payment standard for family of 3: $706
    wa_tanf_payment_standard: 706
    wa_tanf_countable_income: 0
    wa_tanf_eligible: true
    wa_tanf: 706

- name: Case 17, 2024-01 single parent with 2 children, low earned income.
  period: 2024-01
  input:
    people:
      person1:
        age: 30
        employment_income_before_lsr: 6_000
      person2:
        age: 5
        is_tax_unit_dependent: true
      person3:
        age: 3
        is_tax_unit_dependent: true
    families:
      family:
        members: [person1, person2, person3]
    spm_units:
      spm_unit:
        members: [person1, person2, person3]
    tax_units:
      tax_unit:
        members: [person1, person2, person3]
    households:
      household:
        members: [person1, person2, person3]
        state_code: WA
  output:
    wa_tanf_payment_standard: 706
    # Monthly income: $6,000 / 12 = $500
    # Countable earned = $500 × 0.5 = $250 (no $500 flat disregard until Aug 2024)
    wa_tanf_countable_income: 250
    wa_tanf_eligible: true
    wa_tanf: 456

- name: Case 18, 2024-01 single parent with 2 children, income at threshold.
  period: 2024-01
  input:
    people:
      person1:
        age: 30
        employment_income_before_lsr: 16_944
      person2:
        age: 5
        is_tax_unit_dependent: true
      person3:
        age: 3
        is_tax_unit_dependent: true
    families:
      family:
        members: [person1, person2, person3]
    spm_units:
      spm_unit:
        members: [person1, person2, person3]
    tax_units:
      tax_unit:
        members: [person1, person2, person3]
    households:
      household:
        members: [person1, person2, person3]
        state_code: WA
  output:
    wa_tanf_payment_standard: 706
    # Monthly income: $16,944 / 12 = $1,412 (at income limit)
    # Countable earned = $1,412 × 0.5 = $706
    wa_tanf_countable_income: 706
    wa_tanf_eligible: true
    wa_tanf: 0
