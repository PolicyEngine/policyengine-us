# Nebraska ADC Benefit Amount Tests
# Gap Budgeting Methodology:
#   Step 1: Net Earned Income = Gross Earned * 0.50
#   Step 2: Gap = Need Standard - Net Earned Income
#   Step 3: Benefit = min(Gap, Payment Standard)
#   Step 4: Final Benefit = Benefit - Unearned Income
#   Step 5: Apply minimum payment ($10) if benefit > 0 but < $10

- name: Case 1, no income receives maximum benefit.
  period: 2024-01
  absolute_error_margin: 0.5
  input:
    people:
      person1:
        age: 30
        employment_income_before_lsr: 0
      person2:
        age: 10
      person3:
        age: 8
    spm_units:
      spm_unit:
        members: [person1, person2, person3]
        spm_unit_cash_assets: 1_000
    households:
      household:
        members: [person1, person2, person3]
        state_code: NE
  output:
    ne_adc: 485
    # Gap = $881 - $0 = $881
    # Benefit = min($881, $485) = $485
    # Final = $485 - $0 = $485

- name: Case 2, earned income reduces benefit.
  period: 2024-01
  absolute_error_margin: 0.5
  input:
    people:
      person1:
        age: 30
        employment_income_before_lsr: 12_000  # $1,000/month
      person2:
        age: 10
      person3:
        age: 8
    spm_units:
      spm_unit:
        members: [person1, person2, person3]
        spm_unit_cash_assets: 1_000
    households:
      household:
        members: [person1, person2, person3]
        state_code: NE
  output:
    ne_adc: 381
    # Countable earned = $1,000 * 0.50 = $500
    # Gap = $881 - $500 = $381
    # Benefit = min($381, $485) = $381
    # Final = $381 - $0 = $381

- name: Case 3, unearned income reduces benefit.
  period: 2024-01
  absolute_error_margin: 0.5
  input:
    people:
      person1:
        age: 30
        employment_income_before_lsr: 0
        social_security: 6_000  # $500/month
      person2:
        age: 10
      person3:
        age: 8
    spm_units:
      spm_unit:
        members: [person1, person2, person3]
        spm_unit_cash_assets: 1_000
    households:
      household:
        members: [person1, person2, person3]
        state_code: NE
  output:
    ne_adc: 0
    # Gap = $881 - $0 = $881
    # Benefit = min($881, $485) = $485
    # Final = $485 - $500 = -$15 -> $0 (can't be negative)

- name: Case 4, income too high gets zero benefit.
  period: 2024-01
  absolute_error_margin: 0.5
  input:
    people:
      person1:
        age: 30
        employment_income_before_lsr: 24_000  # $2,000/month
      person2:
        age: 10
    spm_units:
      spm_unit:
        members: [person1, person2]
        spm_unit_cash_assets: 1_000
    households:
      household:
        members: [person1, person2]
        state_code: NE
  output:
    ne_adc: 0
    # Countable earned = $2,000 * 0.50 = $1,000
    # Gap = $741 - $1,000 = -$259 (negative, not eligible)
    # Benefit = $0

- name: Case 5, minimum payment rule applies.
  period: 2024-01
  absolute_error_margin: 0.5
  input:
    people:
      person1:
        age: 30
        employment_income_before_lsr: 7_920  # $660/month earned
        social_security: 4_800  # $400/month unearned
      person2:
        age: 10
    spm_units:
      spm_unit:
        members: [person1, person2]
        spm_unit_cash_assets: 1_000
    households:
      household:
        members: [person1, person2]
        state_code: NE
  output:
    ne_adc: 10
    # Countable earned = $660 * 0.50 = $330
    # Gap = $741 - $330 = $411
    # Benefit = min($411, $408) = $408
    # Final = $408 - $400 = $8
    # $8 < $10 minimum, so benefit = $10

- name: Case 6, benefit just above minimum.
  period: 2024-01
  absolute_error_margin: 0.5
  input:
    people:
      person1:
        age: 30
        employment_income_before_lsr: 7_920  # $660/month earned
        social_security: 4_680  # $390/month unearned
      person2:
        age: 10
    spm_units:
      spm_unit:
        members: [person1, person2]
        spm_unit_cash_assets: 1_000
    households:
      household:
        members: [person1, person2]
        state_code: NE
  output:
    ne_adc: 18
    # Countable earned = $660 * 0.50 = $330
    # Gap = $741 - $330 = $411
    # Benefit = min($411, $408) = $408
    # Final = $408 - $390 = $18
    # $18 > $10 minimum, so benefit = $18
