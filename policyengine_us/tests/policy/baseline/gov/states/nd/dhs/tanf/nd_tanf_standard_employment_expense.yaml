# North Dakota TANF Standard Employment Expense Allowance Unit Tests
#
# The Standard Employment Expense (SEE) is calculated as:
# max(27% of gross earned income, $180 minimum)
#
# Crossover Point Analysis:
# - At crossover: 0.27 * income = $180
# - Crossover income: $180 / 0.27 = $666.67
# - Below $666.67: minimum $180 applies
# - Above $666.67: 27% applies
#
# NOTE: Uses employment_income_before_lsr as input since that is what
# tanf_gross_earned_income expects.

- name: Case 1, zero income results in $180 minimum.
  period: 2024-01
  absolute_error_margin: 0.01
  input:
    people:
      person1:
        age: 30
        employment_income_before_lsr: 0
      person2:
        age: 8
    spm_units:
      spm_unit:
        members: [person1, person2]
    households:
      household:
        members: [person1, person2]
        state_code: ND
  output:
    # 27% of $0 = $0
    # max($0, $180) = $180
    nd_tanf_standard_employment_expense: 180

- name: Case 2, very low income uses $180 minimum.
  period: 2024-01
  absolute_error_margin: 0.01
  input:
    people:
      person1:
        age: 25
        # Monthly: $100; Annual: $1,200
        employment_income_before_lsr: 1_200
      person2:
        age: 3
    spm_units:
      spm_unit:
        members: [person1, person2]
    households:
      household:
        members: [person1, person2]
        state_code: ND
  output:
    # Monthly gross: $1,200 / 12 = $100
    # 27% of $100 = $27
    # max($27, $180) = $180 (minimum applies)
    nd_tanf_standard_employment_expense: 180

- name: Case 3, income just below crossover uses $180 minimum.
  period: 2024-01
  absolute_error_margin: 0.01
  input:
    people:
      person1:
        age: 28
        # Monthly: $650; Annual: $7,800
        # 27% of $650 = $175.50 < $180
        employment_income_before_lsr: 7_800
      person2:
        age: 5
    spm_units:
      spm_unit:
        members: [person1, person2]
    households:
      household:
        members: [person1, person2]
        state_code: ND
  output:
    # Monthly gross: $7,800 / 12 = $650
    # 27% of $650 = $175.50
    # max($175.50, $180) = $180 (minimum applies)
    nd_tanf_standard_employment_expense: 180

- name: Case 4, income at exact crossover point.
  period: 2024-01
  absolute_error_margin: 0.01
  input:
    people:
      person1:
        age: 32
        # Monthly: $666.67; Annual: $8,000.04
        # 27% of $666.67 = $180
        # Using $8,000 annual = $666.67 monthly
        employment_income_before_lsr: 8_000
      person2:
        age: 7
    spm_units:
      spm_unit:
        members: [person1, person2]
    households:
      household:
        members: [person1, person2]
        state_code: ND
  output:
    # Monthly gross: $8,000 / 12 = $666.67
    # 27% of $666.67 = $180.00
    # max($180, $180) = $180 (both equal)
    nd_tanf_standard_employment_expense: 180

- name: Case 5, income just above crossover uses 27%.
  period: 2024-01
  absolute_error_margin: 0.01
  input:
    people:
      person1:
        age: 35
        # Monthly: $700; Annual: $8,400
        # 27% of $700 = $189 > $180
        employment_income_before_lsr: 8_400
      person2:
        age: 10
    spm_units:
      spm_unit:
        members: [person1, person2]
    households:
      household:
        members: [person1, person2]
        state_code: ND
  output:
    # Monthly gross: $8,400 / 12 = $700
    # 27% of $700 = $189
    # max($189, $180) = $189 (percentage applies)
    nd_tanf_standard_employment_expense: 189

- name: Case 6, moderate income uses 27%.
  period: 2024-01
  absolute_error_margin: 0.01
  input:
    people:
      person1:
        age: 40
        # Monthly: $1,000; Annual: $12,000
        employment_income_before_lsr: 12_000
      person2:
        age: 12
    spm_units:
      spm_unit:
        members: [person1, person2]
    households:
      household:
        members: [person1, person2]
        state_code: ND
  output:
    # Monthly gross: $12,000 / 12 = $1,000
    # 27% of $1,000 = $270
    # max($270, $180) = $270 (percentage applies)
    nd_tanf_standard_employment_expense: 270

- name: Case 7, high income uses 27%.
  period: 2024-01
  absolute_error_margin: 0.01
  input:
    people:
      person1:
        age: 45
        # Monthly: $3,000; Annual: $36,000
        employment_income_before_lsr: 36_000
      person2:
        age: 15
      person3:
        age: 12
    spm_units:
      spm_unit:
        members: [person1, person2, person3]
    households:
      household:
        members: [person1, person2, person3]
        state_code: ND
  output:
    # Monthly gross: $36,000 / 12 = $3,000
    # 27% of $3,000 = $810
    # max($810, $180) = $810 (percentage applies)
    nd_tanf_standard_employment_expense: 810
