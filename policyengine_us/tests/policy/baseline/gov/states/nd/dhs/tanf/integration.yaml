# North Dakota TANF Integration Tests
# Tests the complete benefit calculation pipeline
#
# Key Parameters (2024-01):
# - Standard Employment Expense: max(27% of gross earned, $180)
# - Time Limited Percentage (TLP) disregard: 50% of remaining earned income
# - Standard of Need: 2D table lookup by caretakers × children
# - Income Eligibility: Countable income < Standard of Need
#
# Source: https://www.nd.gov/dhs/policymanuals/40019/400_19_110_05.htm

- name: Case 1, family of 3 with no income receives full benefit.
  period: 2026-01
  absolute_error_margin: 0.01
  input:
    people:
      person1:
        age: 30
      person2:
        age: 8
      person3:
        age: 5
    spm_units:
      spm_unit:
        members: [person1, person2, person3]
    households:
      household:
        members: [person1, person2, person3]
        state_code: ND
  output:
    # 1 caretaker, 2 children → Standard of Need = $962
    nd_tanf_standard_of_need: 962
    nd_tanf_countable_earned_income: 0
    nd_tanf_countable_unearned_income: 0
    nd_tanf_countable_income: 0
    nd_tanf_income_eligible: true
    nd_tanf_eligible: true
    # Benefit = $962 - $0 = $962
    nd_tanf: 962

- name: Case 2, family of 3 with moderate earned income.
  period: 2026-01
  absolute_error_margin: 0.01
  input:
    people:
      person1:
        age: 35
        # Monthly: $1,500; Annual: $18,000
        employment_income_before_lsr: 18_000
      person2:
        age: 10
      person3:
        age: 7
    spm_units:
      spm_unit:
        members: [person1, person2, person3]
    households:
      household:
        members: [person1, person2, person3]
        state_code: ND
  output:
    # 1 caretaker, 2 children → Standard of Need = $962
    nd_tanf_standard_of_need: 962
    # Gross monthly earned income: $18,000 / 12 = $1,500
    # Standard Employment Expense: max($1,500 * 0.27, $180) = max($405, $180) = $405
    # After SEE: $1,500 - $405 = $1,095
    # TLP disregard (50%): $1,095 * 0.50 = $547.50
    # Countable earned: $1,095 - $547.50 = $547.50
    nd_tanf_countable_earned_income: 547.50
    nd_tanf_countable_unearned_income: 0
    nd_tanf_countable_income: 547.50
    # Income eligible: $547.50 < $962 = true
    nd_tanf_income_eligible: true
    nd_tanf_eligible: true
    # Benefit = $962 - $547.50 = $414.50
    nd_tanf: 414.50

- name: Case 3, family of 3 with earned and unearned income.
  period: 2026-01
  absolute_error_margin: 0.01
  input:
    people:
      person1:
        age: 28
        # Monthly earned: $1,000; Annual: $12,000
        employment_income_before_lsr: 12_000
        # Monthly unearned: $200; Annual: $2,400
        social_security_dependents: 2_400
      person2:
        age: 6
      person3:
        age: 4
    spm_units:
      spm_unit:
        members: [person1, person2, person3]
    households:
      household:
        members: [person1, person2, person3]
        state_code: ND
  output:
    # 1 caretaker, 2 children → Standard of Need = $962
    nd_tanf_standard_of_need: 962
    # Gross monthly earned income: $12,000 / 12 = $1,000
    # Standard Employment Expense: max($1,000 * 0.27, $180) = max($270, $180) = $270
    # After SEE: $1,000 - $270 = $730
    # TLP disregard (50%): $730 * 0.50 = $365
    # Countable earned: $730 - $365 = $365
    nd_tanf_countable_earned_income: 365
    # Countable unearned: $2,400 / 12 = $200
    nd_tanf_countable_unearned_income: 200
    # Total countable: $365 + $200 = $565
    nd_tanf_countable_income: 565
    # Income eligible: $565 < $962 = true
    nd_tanf_income_eligible: true
    nd_tanf_eligible: true
    # Benefit = $962 - $565 = $397
    nd_tanf: 397

- name: Case 4, low earned income applies minimum $180 deduction.
  period: 2026-01
  absolute_error_margin: 0.01
  input:
    people:
      person1:
        age: 25
        # Monthly: $500; Annual: $6,000
        employment_income_before_lsr: 6_000
      person2:
        age: 3
    spm_units:
      spm_unit:
        members: [person1, person2]
    households:
      household:
        members: [person1, person2]
        state_code: ND
  output:
    # 1 caretaker, 1 child → Standard of Need = $739
    nd_tanf_standard_of_need: 739
    # Gross monthly earned income: $6,000 / 12 = $500
    # Standard Employment Expense: max($500 * 0.27, $180) = max($135, $180) = $180
    # After SEE: $500 - $180 = $320
    # TLP disregard (50%): $320 * 0.50 = $160
    # Countable earned: $320 - $160 = $160
    nd_tanf_countable_earned_income: 160
    nd_tanf_countable_unearned_income: 0
    nd_tanf_countable_income: 160
    nd_tanf_income_eligible: true
    nd_tanf_eligible: true
    # Benefit = $739 - $160 = $579
    nd_tanf: 579

- name: Case 5, income resulting in low benefit but above minimum.
  period: 2026-01
  absolute_error_margin: 0.01
  input:
    people:
      person1:
        age: 32
        # Monthly: $1,400; Annual: $16,800
        employment_income_before_lsr: 16_800
      person2:
        age: 2
    spm_units:
      spm_unit:
        members: [person1, person2]
    households:
      household:
        members: [person1, person2]
        state_code: ND
  output:
    # 1 caretaker, 1 child → Standard of Need = $739
    nd_tanf_standard_of_need: 739
    # Monthly earned: $16,800 / 12 = $1,400
    # SEE: max($1,400 * 0.27, $180) = max($378, $180) = $378
    # After SEE: $1,400 - $378 = $1,022
    # TLP: $1,022 * 0.50 = $511
    # Countable earned: $1,022 - $511 = $511
    nd_tanf_countable_earned_income: 511
    nd_tanf_countable_income: 511
    # Income eligible: $511 < $739 = true
    nd_tanf_income_eligible: true
    nd_tanf_eligible: true
    # Benefit = $739 - $511 = $228
    nd_tanf: 228

- name: Case 6, income over eligibility limit results in zero benefit.
  period: 2026-01
  absolute_error_margin: 0.01
  input:
    people:
      person1:
        age: 40
        # Monthly: $3,000; Annual: $36,000
        employment_income_before_lsr: 36_000
      person2:
        age: 12
      person3:
        age: 9
    spm_units:
      spm_unit:
        members: [person1, person2, person3]
    households:
      household:
        members: [person1, person2, person3]
        state_code: ND
  output:
    # 1 caretaker, 2 children → Standard of Need = $962
    nd_tanf_standard_of_need: 962
    # Monthly earned: $36,000 / 12 = $3,000
    # SEE: max($3,000 * 0.27, $180) = max($810, $180) = $810
    # After SEE: $3,000 - $810 = $2,190
    # TLP: $2,190 * 0.50 = $1,095
    # Countable earned: $2,190 - $1,095 = $1,095
    nd_tanf_countable_earned_income: 1_095
    nd_tanf_countable_income: 1_095
    # Income eligible: $1,095 < $962 = false
    nd_tanf_income_eligible: false
    nd_tanf_eligible: false
    nd_tanf: 0

- name: Case 7, pregnant woman with unearned income only.
  period: 2026-01
  absolute_error_margin: 0.01
  input:
    people:
      person1:
        age: 22
        is_pregnant: true
        # Monthly unearned: $400; Annual: $4,800
        social_security_dependents: 4_800
    spm_units:
      spm_unit:
        members: [person1]
    households:
      household:
        members: [person1]
        state_code: ND
  output:
    # 1 caretaker, 0 children → Standard of Need = $523
    nd_tanf_standard_of_need: 523
    # No earned income, so no deductions
    nd_tanf_countable_earned_income: 0
    # Countable unearned: $4,800 / 12 = $400
    nd_tanf_countable_unearned_income: 400
    nd_tanf_countable_income: 400
    # Income eligible: $400 < $523 = true
    nd_tanf_income_eligible: true
    nd_tanf_eligible: true
    # Benefit = $523 - $400 = $123
    nd_tanf: 123

- name: Case 8, large household with moderate income.
  period: 2026-01
  absolute_error_margin: 0.01
  input:
    people:
      person1:
        age: 45
        # Monthly: $2,000; Annual: $24,000
        employment_income_before_lsr: 24_000
      person2:
        age: 43
      person3:
        age: 17
      person4:
        age: 15
      person5:
        age: 12
      person6:
        age: 9
      person7:
        age: 6
      person8:
        age: 3
    spm_units:
      spm_unit:
        members: [person1, person2, person3, person4, person5, person6, person7, person8]
    households:
      household:
        members: [person1, person2, person3, person4, person5, person6, person7, person8]
        state_code: ND
  output:
    # 2 caretakers, 6 children → Standard of Need = $2,049
    nd_tanf_standard_of_need: 2_049
    # Monthly earned: $24,000 / 12 = $2,000
    # SEE: max($2,000 * 0.27, $180) = max($540, $180) = $540
    # After SEE: $2,000 - $540 = $1,460
    # TLP: $1,460 * 0.50 = $730
    # Countable earned: $1,460 - $730 = $730
    nd_tanf_countable_earned_income: 730
    nd_tanf_countable_unearned_income: 0
    nd_tanf_countable_income: 730
    # Income eligible: $730 < $2,049 = true
    nd_tanf_income_eligible: true
    # Resource limit for 8 persons: $6,000 + $25 * 6 = $6,150
    nd_tanf_resources_eligible: true
    nd_tanf_eligible: true
    # Benefit = $2,049 - $730 = $1,319
    nd_tanf: 1_319

- name: Case 9, ineligible due to resources exceeding limit.
  period: 2026-01
  absolute_error_margin: 0.01
  input:
    people:
      person1:
        age: 30
      person2:
        age: 8
    spm_units:
      spm_unit:
        members: [person1, person2]
        # Resources over limit ($6,000 for 2 persons)
        spm_unit_assets: 6_500
    households:
      household:
        members: [person1, person2]
        state_code: ND
  output:
    # 1 caretaker, 1 child → Standard of Need = $739
    nd_tanf_standard_of_need: 739
    nd_tanf_countable_income: 0
    nd_tanf_income_eligible: true
    # Resource limit for 2 persons: $6,000
    # $6,500 > $6,000 = false
    nd_tanf_resources_eligible: false
    nd_tanf_eligible: false
    nd_tanf: 0

- name: Case 10, very low income where deductions exceed gross.
  period: 2026-01
  absolute_error_margin: 0.01
  input:
    people:
      person1:
        age: 26
        # Monthly: $100; Annual: $1,200
        employment_income_before_lsr: 1_200
      person2:
        age: 4
    spm_units:
      spm_unit:
        members: [person1, person2]
    households:
      household:
        members: [person1, person2]
        state_code: ND
  output:
    # 1 caretaker, 1 child → Standard of Need = $739
    nd_tanf_standard_of_need: 739
    # Monthly gross: $1,200 / 12 = $100
    # SEE: max($100 * 0.27, $180) = max($27, $180) = $180
    # After SEE: max($100 - $180, 0) = $0 (clipped)
    # TLP: $0 * 0.50 = $0
    # Countable earned: max($100 - $180 - $0, 0) = $0
    nd_tanf_countable_earned_income: 0
    nd_tanf_countable_unearned_income: 0
    nd_tanf_countable_income: 0
    nd_tanf_income_eligible: true
    nd_tanf_eligible: true
    # Benefit = $739 - $0 = $739
    nd_tanf: 739

- name: Case 11, small benefit with high unearned income.
  period: 2026-01
  absolute_error_margin: 0.01
  input:
    people:
      person1:
        age: 30
        # Unearned income: $732 * 12 = $8,784
        social_security_dependents: 8_784
      person2:
        age: 5
    spm_units:
      spm_unit:
        members: [person1, person2]
    households:
      household:
        members: [person1, person2]
        state_code: ND
  output:
    # 1 caretaker, 1 child → Standard of Need = $739
    nd_tanf_standard_of_need: 739
    nd_tanf_countable_earned_income: 0
    # Countable unearned: $8,784 / 12 = $732
    nd_tanf_countable_unearned_income: 732
    nd_tanf_countable_income: 732
    # Income eligible: $732 < $739 = true
    nd_tanf_income_eligible: true
    nd_tanf_eligible: true
    # Benefit = $739 - $732 = $7
    nd_tanf: 7

- name: Case 12, very small benefit with high unearned income.
  period: 2026-01
  absolute_error_margin: 0.01
  input:
    people:
      person1:
        age: 28
        # Unearned: $735 * 12 = $8,820
        social_security_dependents: 8_820
      person2:
        age: 3
    spm_units:
      spm_unit:
        members: [person1, person2]
    households:
      household:
        members: [person1, person2]
        state_code: ND
  output:
    # 1 caretaker, 1 child → Standard of Need = $739
    nd_tanf_standard_of_need: 739
    nd_tanf_countable_earned_income: 0
    # Countable unearned: $8,820 / 12 = $735
    nd_tanf_countable_unearned_income: 735
    nd_tanf_countable_income: 735
    # Income eligible: $735 < $739 = true
    nd_tanf_income_eligible: true
    nd_tanf_eligible: true
    # Benefit = $739 - $735 = $4
    nd_tanf: 4

- name: Case 13, two working parents (multiple earners).
  period: 2026-01
  absolute_error_margin: 0.01
  input:
    people:
      person1:
        age: 35
        # Monthly: $1,000; Annual: $12,000
        employment_income_before_lsr: 12_000
      person2:
        age: 33
        # Monthly: $800; Annual: $9,600
        employment_income_before_lsr: 9_600
      person3:
        age: 10
      person4:
        age: 7
    spm_units:
      spm_unit:
        members: [person1, person2, person3, person4]
    households:
      household:
        members: [person1, person2, person3, person4]
        state_code: ND
  output:
    # 2 caretakers, 2 children → Standard of Need = $1,175
    nd_tanf_standard_of_need: 1_175
    # Person 1: $1,000/month
    # SEE: max($1,000 * 0.27, $180) = max($270, $180) = $270
    # After SEE: $1,000 - $270 = $730
    # TLP: $730 * 0.50 = $365
    # Countable: $730 - $365 = $365
    # Person 2: $800/month
    # SEE: max($800 * 0.27, $180) = max($216, $180) = $216
    # After SEE: $800 - $216 = $584
    # TLP: $584 * 0.50 = $292
    # Countable: $584 - $292 = $292
    # Total countable earned: $365 + $292 = $657
    nd_tanf_countable_earned_income: 657
    nd_tanf_countable_income: 657
    nd_tanf_income_eligible: true
    nd_tanf_eligible: true
    # Benefit = $1,175 - $657 = $518
    nd_tanf: 518

- name: Case 14, child-only household (zero caretakers).
  period: 2026-01
  absolute_error_margin: 0.01
  input:
    people:
      person1:
        age: 16
      person2:
        age: 14
    spm_units:
      spm_unit:
        members: [person1, person2]
    households:
      household:
        members: [person1, person2]
        state_code: ND
  output:
    # 0 caretakers, 2 children → Standard of Need = $536
    nd_tanf_standard_of_need: 536
    nd_tanf_countable_earned_income: 0
    nd_tanf_countable_income: 0
    nd_tanf_income_eligible: true
    nd_tanf_eligible: true
    # Benefit = $536 - $0 = $536
    nd_tanf: 536

- name: Case 15, three adults caps caretakers at two.
  period: 2026-01
  absolute_error_margin: 0.01
  input:
    people:
      person1:
        age: 45
      person2:
        age: 42
      person3:
        age: 20
      person4:
        age: 12
      person5:
        age: 8
    spm_units:
      spm_unit:
        members: [person1, person2, person3, person4, person5]
    households:
      household:
        members: [person1, person2, person3, person4, person5]
        state_code: ND
  output:
    # 3 adults in household, but caretakers capped at 2
    # 2 caretakers (capped), 2 children → Standard of Need = $1,175
    nd_tanf_standard_of_need: 1_175
    nd_tanf_countable_income: 0
    nd_tanf_income_eligible: true
    nd_tanf_eligible: true
    # Benefit = $1,175 - $0 = $1,175
    nd_tanf: 1_175

- name: Case 16, eleven children caps at ten.
  period: 2026-01
  absolute_error_margin: 0.01
  input:
    people:
      person1:
        age: 40
      person2:
        age: 17
      person3:
        age: 16
      person4:
        age: 15
      person5:
        age: 14
      person6:
        age: 13
      person7:
        age: 11
      person8:
        age: 9
      person9:
        age: 7
      person10:
        age: 5
      person11:
        age: 3
      person12:
        age: 1
    spm_units:
      spm_unit:
        members: [person1, person2, person3, person4, person5, person6, person7, person8, person9, person10, person11, person12]
    households:
      household:
        members: [person1, person2, person3, person4, person5, person6, person7, person8, person9, person10, person11, person12]
        state_code: ND
  output:
    # 1 caretaker, 11 children in household, but children capped at 10
    # 1 caretaker, 10 children (capped) → Standard of Need = $2,702
    nd_tanf_standard_of_need: 2_702
    nd_tanf_countable_income: 0
    nd_tanf_income_eligible: true
    nd_tanf_eligible: true
    # Benefit = $2,702 - $0 = $2,702
    nd_tanf: 2_702

- name: Case 17, two low-income earners each get $180 minimum SEE.
  period: 2026-01
  absolute_error_margin: 0.01
  input:
    people:
      person1:
        age: 35
        # Monthly: $500; Annual: $6,000
        employment_income_before_lsr: 6_000
      person2:
        age: 33
        # Monthly: $500; Annual: $6,000
        employment_income_before_lsr: 6_000
      person3:
        age: 10
      person4:
        age: 7
    spm_units:
      spm_unit:
        members: [person1, person2, person3, person4]
    households:
      household:
        members: [person1, person2, person3, person4]
        state_code: ND
  output:
    # 2 caretakers, 2 children → Standard of Need = $1,175
    nd_tanf_standard_of_need: 1_175
    # Per-person calculation (each earner gets own $180 minimum):
    # Person 1: $500/month
    #   SEE: max($500 * 0.27, $180) = max($135, $180) = $180
    #   After SEE: $500 - $180 = $320
    #   TLP: $320 * 0.50 = $160
    #   Countable: $320 - $160 = $160
    # Person 2: $500/month
    #   SEE: max($500 * 0.27, $180) = max($135, $180) = $180
    #   After SEE: $500 - $180 = $320
    #   TLP: $320 * 0.50 = $160
    #   Countable: $320 - $160 = $160
    # Total countable earned: $160 + $160 = $320
    # Note: If calculated at household level, would incorrectly be:
    #   SEE: max($1,000 * 0.27, $180) = $270
    #   After: $730, TLP: $365, Countable: $365
    nd_tanf_countable_earned_income: 320
    nd_tanf_countable_income: 320
    nd_tanf_income_eligible: true
    nd_tanf_eligible: true
    # Benefit = $1,175 - $320 = $855
    nd_tanf: 855

- name: Case 18, child-only household with minor's earned income.
  period: 2026-01
  absolute_error_margin: 0.01
  input:
    people:
      person1:
        age: 17
        # Minor works part-time: $400/month = $4,800/year
        employment_income_before_lsr: 4_800
      person2:
        age: 14
    spm_units:
      spm_unit:
        members: [person1, person2]
    households:
      household:
        members: [person1, person2]
        state_code: ND
  output:
    # 0 caretakers, 2 children → Standard of Need = $536
    nd_tanf_standard_of_need: 536
    # Person 1 (17 y/o): $400/month
    #   SEE: max($400 * 0.27, $180) = max($108, $180) = $180
    #   After SEE: $400 - $180 = $220
    #   TLP: $220 * 0.50 = $110
    #   Countable: $220 - $110 = $110
    nd_tanf_countable_earned_income: 110
    nd_tanf_countable_income: 110
    # $110 < $536 = true
    nd_tanf_income_eligible: true
    nd_tanf_eligible: true
    # Benefit = $536 - $110 = $426
    nd_tanf: 426

- name: Case 19, three earners with varying incomes.
  period: 2026-01
  absolute_error_margin: 0.01
  input:
    people:
      person1:
        age: 45
        # High earner: $2,000/month = $24,000/year
        employment_income_before_lsr: 24_000
      person2:
        age: 43
        # Medium earner: $800/month = $9,600/year
        employment_income_before_lsr: 9_600
      person3:
        age: 20
        # Low earner: $300/month = $3,600/year (uses $180 minimum)
        employment_income_before_lsr: 3_600
      person4:
        age: 10
      person5:
        age: 7
    spm_units:
      spm_unit:
        members: [person1, person2, person3, person4, person5]
    households:
      household:
        members: [person1, person2, person3, person4, person5]
        state_code: ND
  output:
    # 3 caretakers capped at 2, 2 children → Standard = $1,175
    nd_tanf_standard_of_need: 1_175
    # Person 1: $2,000/mo
    #   SEE: max($540, $180) = $540
    #   After: $1,460, TLP: $730, Countable: $730
    # Person 2: $800/mo
    #   SEE: max($216, $180) = $216
    #   After: $584, TLP: $292, Countable: $292
    # Person 3: $300/mo
    #   SEE: max($81, $180) = $180
    #   After: $120, TLP: $60, Countable: $60
    # Total: $730 + $292 + $60 = $1,082
    nd_tanf_countable_earned_income: 1_082
    nd_tanf_countable_income: 1_082
    # $1,082 < $1,175 = true
    nd_tanf_income_eligible: true
    nd_tanf_eligible: true
    # Benefit = $1,175 - $1,082 = $93
    nd_tanf: 93

- name: Case 20, one earner with high income plus one with $1 income.
  period: 2026-01
  absolute_error_margin: 0.01
  input:
    people:
      person1:
        age: 35
        # $2,000/month = $24,000/year
        employment_income_before_lsr: 24_000
      person2:
        age: 33
        # $1/month = $12/year (tests minimum clip to zero)
        employment_income_before_lsr: 12
      person3:
        age: 8
    spm_units:
      spm_unit:
        members: [person1, person2, person3]
    households:
      household:
        members: [person1, person2, person3]
        state_code: ND
  output:
    # 2 caretakers, 1 child → Standard of Need = $962
    nd_tanf_standard_of_need: 962
    # Person 1: $2,000/mo
    #   SEE: max($540, $180) = $540
    #   After: $1,460, TLP: $730, Countable: $730
    # Person 2: $1/mo
    #   SEE: max($0.27, $180) = $180
    #   After: max($1 - $180, 0) = $0 (clipped)
    #   TLP: $0, Countable: $0
    # Total countable earned: $730 + $0 = $730
    nd_tanf_countable_earned_income: 730
    nd_tanf_countable_income: 730
    # $730 < $962 = true
    nd_tanf_income_eligible: true
    nd_tanf_eligible: true
    # Benefit = $962 - $730 = $232
    nd_tanf: 232

- name: Case 21, benefit of exactly one dollar.
  period: 2026-01
  absolute_error_margin: 0.01
  input:
    people:
      person1:
        age: 30
        # Unearned: $738 * 12 = $8,856/year
        social_security_dependents: 8_856
      person2:
        age: 5
    spm_units:
      spm_unit:
        members: [person1, person2]
    households:
      household:
        members: [person1, person2]
        state_code: ND
  output:
    # 1 caretaker, 1 child → Standard = $739
    nd_tanf_standard_of_need: 739
    nd_tanf_countable_earned_income: 0
    # Countable unearned: $8,856 / 12 = $738
    nd_tanf_countable_unearned_income: 738
    nd_tanf_countable_income: 738
    # $738 < $739 = true
    nd_tanf_income_eligible: true
    nd_tanf_eligible: true
    # Benefit = $739 - $738 = $1
    nd_tanf: 1

- name: Case 22, child support exclusion reduces countable income.
  period: 2026-01
  absolute_error_margin: 0.01
  input:
    people:
      person1:
        age: 28
        # Social security: $300/month = $3,600/year
        social_security_dependents: 3_600
        # Child support: $200/month = $2,400/year (excluded)
        child_support_received: 2_400
      person2:
        age: 6
      person3:
        age: 4
    spm_units:
      spm_unit:
        members: [person1, person2, person3]
    households:
      household:
        members: [person1, person2, person3]
        state_code: ND
  output:
    # 1 caretaker, 2 children → Standard of Need = $962
    nd_tanf_standard_of_need: 962
    nd_tanf_countable_earned_income: 0
    # Gross unearned: $300 + $200 = $500
    # Less child support: $500 - $200 = $300
    nd_tanf_countable_unearned_income: 300
    nd_tanf_countable_income: 300
    # $300 < $962 = true
    nd_tanf_income_eligible: true
    nd_tanf_eligible: true
    # Benefit = $962 - $300 = $662
    nd_tanf: 662

- name: Case 23, child support as only income results in full benefit.
  period: 2026-01
  absolute_error_margin: 0.01
  input:
    people:
      person1:
        age: 25
        # Only child support: $400/month = $4,800/year (fully excluded)
        child_support_received: 4_800
      person2:
        age: 3
    spm_units:
      spm_unit:
        members: [person1, person2]
    households:
      household:
        members: [person1, person2]
        state_code: ND
  output:
    # 1 caretaker, 1 child → Standard of Need = $739
    nd_tanf_standard_of_need: 739
    nd_tanf_countable_earned_income: 0
    # Child support is fully excluded
    nd_tanf_countable_unearned_income: 0
    nd_tanf_countable_income: 0
    nd_tanf_income_eligible: true
    nd_tanf_eligible: true
    # Benefit = $739 - $0 = $739 (full benefit)
    nd_tanf: 739

- name: Case 24, maximum possible benefit (2 caretakers, 10 children).
  period: 2026-01
  absolute_error_margin: 0.01
  input:
    people:
      person1:
        age: 45
      person2:
        age: 43
      person3:
        age: 17
      person4:
        age: 16
      person5:
        age: 15
      person6:
        age: 14
      person7:
        age: 12
      person8:
        age: 10
      person9:
        age: 8
      person10:
        age: 6
      person11:
        age: 4
      person12:
        age: 2
    spm_units:
      spm_unit:
        members: [person1, person2, person3, person4, person5, person6, person7, person8, person9, person10, person11, person12]
    households:
      household:
        members: [person1, person2, person3, person4, person5, person6, person7, person8, person9, person10, person11, person12]
        state_code: ND
  output:
    # 2 caretakers, 10 children (capped) → Maximum Standard of Need = $2,922
    nd_tanf_standard_of_need: 2_922
    nd_tanf_countable_earned_income: 0
    nd_tanf_countable_unearned_income: 0
    nd_tanf_countable_income: 0
    nd_tanf_income_eligible: true
    nd_tanf_eligible: true
    # Maximum benefit = $2,922 - $0 = $2,922
    nd_tanf: 2_922

- name: Case 25, self-employment income included in earned income.
  period: 2026-01
  absolute_error_margin: 0.01
  input:
    people:
      person1:
        age: 35
        # Self-employment: $1,200/month = $14,400/year
        self_employment_income_before_lsr: 14_400
      person2:
        age: 8
      person3:
        age: 5
    spm_units:
      spm_unit:
        members: [person1, person2, person3]
    households:
      household:
        members: [person1, person2, person3]
        state_code: ND
  output:
    # 1 caretaker, 2 children → Standard of Need = $962
    nd_tanf_standard_of_need: 962
    # Gross self-employment: $14,400 / 12 = $1,200/month
    # SEE: max($1,200 * 0.27, $180) = max($324, $180) = $324
    # After SEE: $1,200 - $324 = $876
    # TLP: $876 * 0.50 = $438
    # Countable earned: $876 - $438 = $438
    nd_tanf_countable_earned_income: 438
    nd_tanf_countable_unearned_income: 0
    nd_tanf_countable_income: 438
    # Income eligible: $438 < $962 = true
    nd_tanf_income_eligible: true
    nd_tanf_eligible: true
    # Benefit = $962 - $438 = $524
    nd_tanf: 524

- name: Case 26, mixed employment and self-employment income.
  period: 2026-01
  absolute_error_margin: 0.01
  input:
    people:
      person1:
        age: 32
        # Employment: $800/month = $9,600/year
        employment_income_before_lsr: 9_600
        # Self-employment: $400/month = $4,800/year
        self_employment_income_before_lsr: 4_800
      person2:
        age: 6
    spm_units:
      spm_unit:
        members: [person1, person2]
    households:
      household:
        members: [person1, person2]
        state_code: ND
  output:
    # 1 caretaker, 1 child → Standard of Need = $739
    nd_tanf_standard_of_need: 739
    # Total gross earned: ($9,600 + $4,800) / 12 = $1,200/month
    # SEE: max($1,200 * 0.27, $180) = max($324, $180) = $324
    # After SEE: $1,200 - $324 = $876
    # TLP: $876 * 0.50 = $438
    # Countable earned: $876 - $438 = $438
    nd_tanf_countable_earned_income: 438
    nd_tanf_countable_unearned_income: 0
    nd_tanf_countable_income: 438
    # Income eligible: $438 < $739 = true
    nd_tanf_income_eligible: true
    nd_tanf_eligible: true
    # Benefit = $739 - $438 = $301
    nd_tanf: 301
