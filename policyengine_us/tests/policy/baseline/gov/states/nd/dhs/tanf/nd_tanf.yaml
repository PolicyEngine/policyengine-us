# North Dakota TANF Benefit Amount Unit Tests
#
# Benefit = max(Standard of Need - Countable Income, 0)
# If benefit < $10, no benefit is issued (minimum benefit rule)
#
# NOTE: Tests must include people and proper entity structure for
# defined_for = StateCode.ND to work correctly.

- name: Case 1, not eligible receives zero.
  period: 2024-01
  absolute_error_margin: 0.01
  input:
    people:
      person1:
        age: 30
    spm_units:
      spm_unit:
        members: [person1]
        nd_tanf_eligible: false
        nd_tanf_standard_of_need: 1_000
        nd_tanf_countable_income: 0
    households:
      household:
        members: [person1]
        state_code: ND
  output:
    nd_tanf: 0

- name: Case 2, eligible with zero income receives full benefit.
  period: 2024-01
  absolute_error_margin: 0.01
  input:
    people:
      person1:
        age: 30
    spm_units:
      spm_unit:
        members: [person1]
        nd_tanf_eligible: true
        nd_tanf_standard_of_need: 1_035.83
        nd_tanf_countable_income: 0
    households:
      household:
        members: [person1]
        state_code: ND
  output:
    # Benefit = $1,035.83 - $0 = $1,035.83
    nd_tanf: 1_035.83

- name: Case 3, eligible with partial income receives reduced benefit.
  period: 2024-01
  absolute_error_margin: 0.01
  input:
    people:
      person1:
        age: 30
    spm_units:
      spm_unit:
        members: [person1]
        nd_tanf_eligible: true
        nd_tanf_standard_of_need: 850
        nd_tanf_countable_income: 400
    households:
      household:
        members: [person1]
        state_code: ND
  output:
    # Benefit = $850 - $400 = $450
    nd_tanf: 450

- name: Case 4, eligible with income at standard receives zero.
  period: 2024-01
  absolute_error_margin: 0.01
  input:
    people:
      person1:
        age: 30
    spm_units:
      spm_unit:
        members: [person1]
        nd_tanf_eligible: true
        nd_tanf_standard_of_need: 850
        nd_tanf_countable_income: 850
    households:
      household:
        members: [person1]
        state_code: ND
  output:
    # Benefit = $850 - $850 = $0
    nd_tanf: 0

- name: Case 5, eligible with income above standard receives zero.
  period: 2024-01
  absolute_error_margin: 0.01
  input:
    people:
      person1:
        age: 30
    spm_units:
      spm_unit:
        members: [person1]
        nd_tanf_eligible: true
        nd_tanf_standard_of_need: 850
        nd_tanf_countable_income: 900
    households:
      household:
        members: [person1]
        state_code: ND
  output:
    # Benefit = max($850 - $900, 0) = $0
    nd_tanf: 0

- name: Case 6, benefit below minimum threshold receives zero.
  period: 2024-01
  absolute_error_margin: 0.01
  input:
    people:
      person1:
        age: 30
    spm_units:
      spm_unit:
        members: [person1]
        nd_tanf_eligible: true
        nd_tanf_standard_of_need: 850
        nd_tanf_countable_income: 845
    households:
      household:
        members: [person1]
        state_code: ND
  output:
    # Benefit = $850 - $845 = $5
    # $5 < $10 minimum, so no benefit issued
    nd_tanf: 0

- name: Case 7, benefit at minimum threshold is issued.
  period: 2024-01
  absolute_error_margin: 0.01
  input:
    people:
      person1:
        age: 30
    spm_units:
      spm_unit:
        members: [person1]
        nd_tanf_eligible: true
        nd_tanf_standard_of_need: 850
        nd_tanf_countable_income: 840
    households:
      household:
        members: [person1]
        state_code: ND
  output:
    # Benefit = $850 - $840 = $10
    # $10 >= $10 minimum, so benefit is issued
    nd_tanf: 10

- name: Case 8, benefit just above minimum threshold.
  period: 2024-01
  absolute_error_margin: 0.01
  input:
    people:
      person1:
        age: 30
    spm_units:
      spm_unit:
        members: [person1]
        nd_tanf_eligible: true
        nd_tanf_standard_of_need: 850
        nd_tanf_countable_income: 835
    households:
      household:
        members: [person1]
        state_code: ND
  output:
    # Benefit = $850 - $835 = $15
    # $15 >= $10 minimum, so benefit is issued
    nd_tanf: 15
