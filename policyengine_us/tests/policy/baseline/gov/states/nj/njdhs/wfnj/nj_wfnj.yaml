# Tests for NJ WFNJ benefit calculation.
# Benefit = max(maximum_benefit - countable_income, 0) if eligible, else 0
# Maximum benefit by household size: 1=$214, 2=$425, 3=$559, 4=$644...

- name: Case 1, eligible with no income - full benefit.
  period: 2024-01
  input:
    people:
      person1:
        age: 30
        is_citizen_or_legal_immigrant: true
      person2:
        age: 5
        is_citizen_or_legal_immigrant: true
    spm_units:
      spm_unit:
        members: [person1, person2]
        spm_unit_size: 2
        spm_unit_assets: 1_000
        is_demographic_tanf_eligible: true
    households:
      household:
        members: [person1, person2]
        state_code: NJ
  output:
    nj_wfnj_eligible: true
    # Maximum benefit for 2 people: $425
    nj_wfnj_maximum_benefit: 425
    # Countable income: $0
    nj_wfnj_countable_earned_income: 0
    nj_wfnj_countable_gross_unearned_income: 0
    # Benefit = $425 - $0 = $425
    nj_wfnj: 425

- name: Case 2, eligible with income - reduced benefit.
  period: 2024-01
  input:
    people:
      person1:
        age: 35
        is_citizen_or_legal_immigrant: true
        social_security: 1_200  # $100/month
    spm_units:
      spm_unit:
        members: [person1]
        spm_unit_size: 1
        spm_unit_assets: 500
        is_demographic_tanf_eligible: true
    households:
      household:
        members: [person1]
        state_code: NJ
  output:
    nj_wfnj_eligible: true
    # Maximum benefit for 1 person: $214
    nj_wfnj_maximum_benefit: 214
    # Unearned income: $1,200/12 = $100/month
    nj_wfnj_countable_gross_unearned_income: 100
    # Benefit = $214 - $100 = $114
    nj_wfnj: 114

- name: Case 3, ineligible - zero benefit.
  period: 2024-01
  input:
    people:
      person1:
        age: 28
        is_citizen_or_legal_immigrant: true
        social_security: 12_000  # $1,000/month
      person2:
        age: 6
        is_citizen_or_legal_immigrant: true
    spm_units:
      spm_unit:
        members: [person1, person2]
        spm_unit_size: 2
        spm_unit_assets: 500
        is_demographic_tanf_eligible: true
    households:
      household:
        members: [person1, person2]
        state_code: NJ
  output:
    # Max allowable for 2: $638, income $1,000 > $638
    nj_wfnj_income_eligible: false
    nj_wfnj_eligible: false
    nj_wfnj: 0

- name: Case 4, income exceeds max benefit - clipped to zero.
  period: 2024-01
  input:
    people:
      person1:
        age: 25
        is_citizen_or_legal_immigrant: true
        social_security: 2_640  # $220/month, just above $214 max benefit for 1
    spm_units:
      spm_unit:
        members: [person1]
        spm_unit_size: 1
        spm_unit_assets: 500
        is_demographic_tanf_eligible: true
    households:
      household:
        members: [person1]
        state_code: NJ
  output:
    # Maximum benefit for 1: $214
    nj_wfnj_maximum_benefit: 214
    # Maximum allowable income for 1: $321
    nj_wfnj_maximum_allowable_income: 321
    # Unearned income: $2,640/12 = $220/month
    nj_wfnj_countable_gross_unearned_income: 220
    # Income $220 <= $321, but $220 >= $214 max benefit
    # Income eligibility requires: income < max benefit
    nj_wfnj_income_eligible: false
    nj_wfnj_eligible: false
    # Ineligible, so benefit = 0
    nj_wfnj: 0
