# Tests for NJ WFNJ eligibility determination.
# Eligibility requires all of:
# 1. Income eligible (income <= max allowable AND income < max benefit)
# 2. Resources eligible (resources <= $2,000)
# 3. Demographic eligible (has eligible child/parent per federal TANF rules)
# 4. At least one citizen or legal immigrant in household

- name: Case 1, all conditions met - eligible.
  period: 2024-01
  input:
    people:
      person1:
        age: 30
        is_citizen_or_legal_immigrant: true
      person2:
        age: 5
        is_citizen_or_legal_immigrant: true
    spm_units:
      spm_unit:
        members: [person1, person2]
        spm_unit_size: 2
        spm_unit_assets: 1_000
        is_demographic_tanf_eligible: true
    households:
      household:
        members: [person1, person2]
        state_code: NJ
  output:
    # Income eligible: $0 income <= $638 max allowable AND $0 < $425 max benefit
    nj_wfnj_income_eligible: true
    # Resources eligible: $1,000 <= $2,000 limit
    nj_wfnj_resources_eligible: true
    # All conditions met
    nj_wfnj_eligible: true

- name: Case 2, income ineligible - not eligible.
  period: 2024-01
  input:
    people:
      person1:
        age: 35
        is_citizen_or_legal_immigrant: true
        social_security: 12_000  # $1,000/month
      person2:
        age: 4
        is_citizen_or_legal_immigrant: true
    spm_units:
      spm_unit:
        members: [person1, person2]
        spm_unit_size: 2
        spm_unit_assets: 500
        is_demographic_tanf_eligible: true
    households:
      household:
        members: [person1, person2]
        state_code: NJ
  output:
    # Unearned income: $12,000/12 = $1,000/month
    # Max allowable for 2 people: $638
    # $1,000 > $638, so income ineligible
    nj_wfnj_income_eligible: false
    nj_wfnj_resources_eligible: true
    nj_wfnj_eligible: false

- name: Case 3, resources ineligible - not eligible.
  period: 2024-01
  input:
    people:
      person1:
        age: 28
        is_citizen_or_legal_immigrant: true
      person2:
        age: 6
        is_citizen_or_legal_immigrant: true
    spm_units:
      spm_unit:
        members: [person1, person2]
        spm_unit_size: 2
        spm_unit_assets: 3_000
        is_demographic_tanf_eligible: true
    households:
      household:
        members: [person1, person2]
        state_code: NJ
  output:
    # No income, so income eligible
    nj_wfnj_income_eligible: true
    # Resources: $3,000 > $2,000 limit
    nj_wfnj_resources_eligible: false
    nj_wfnj_eligible: false

- name: Case 4, demographic ineligible - not eligible.
  period: 2024-01
  input:
    people:
      person1:
        age: 30
        is_citizen_or_legal_immigrant: true
      person2:
        age: 40
        is_citizen_or_legal_immigrant: true
    spm_units:
      spm_unit:
        members: [person1, person2]
        spm_unit_size: 2
        spm_unit_assets: 1_000
        is_demographic_tanf_eligible: false
    households:
      household:
        members: [person1, person2]
        state_code: NJ
  output:
    nj_wfnj_income_eligible: true
    nj_wfnj_resources_eligible: true
    # Demographic ineligible (no eligible child)
    nj_wfnj_eligible: false

- name: Case 5, no citizen or legal immigrant - not eligible.
  period: 2024-01
  input:
    people:
      person1:
        age: 32
        is_citizen_or_legal_immigrant: false
      person2:
        age: 7
        is_citizen_or_legal_immigrant: false
    spm_units:
      spm_unit:
        members: [person1, person2]
        spm_unit_size: 2
        spm_unit_assets: 1_000
        is_demographic_tanf_eligible: true
    households:
      household:
        members: [person1, person2]
        state_code: NJ
  output:
    nj_wfnj_income_eligible: true
    nj_wfnj_resources_eligible: true
    # No citizen or legal immigrant in household
    nj_wfnj_eligible: false

- name: Case 6, mixed citizen and non-citizen household - eligible.
  period: 2024-01
  input:
    people:
      person1:
        age: 30
        is_citizen_or_legal_immigrant: false
      person2:
        age: 5
        is_citizen_or_legal_immigrant: true  # At least one citizen
    spm_units:
      spm_unit:
        members: [person1, person2]
        spm_unit_size: 2
        spm_unit_assets: 1_000
        is_demographic_tanf_eligible: true
    households:
      household:
        members: [person1, person2]
        state_code: NJ
  output:
    nj_wfnj_income_eligible: true
    nj_wfnj_resources_eligible: true
    # At least one citizen or legal immigrant in household
    nj_wfnj_eligible: true
