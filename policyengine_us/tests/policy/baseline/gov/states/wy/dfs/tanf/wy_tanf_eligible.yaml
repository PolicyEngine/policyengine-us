# Wyoming TANF Overall Eligibility Tests
# Tests the combined eligibility check
# Must pass: income eligibility AND resource eligibility AND demographic eligibility
# Source: Wyoming DFS Policy Manual

- name: Case 1, meets all eligibility criteria.
  period: 2025-01
  input:
    people:
      person1:
        age: 30
      person2:
        age: 10
    spm_units:
      spm_unit:
        members: [person1, person2]
        spm_unit_is_married: false
        spm_unit_assets: 2_000
    households:
      household:
        members: [person1, person2]
        state_code: WY
  output:
    # Income: $0 < $1,447 → Income eligible: true
    # Resources: $2,000 < $5,000 → Resources eligible: true
    # Has child under 18 → Demographic eligible: true
    # All checks pass → Eligible: true
    wy_tanf_income_eligible: true
    wy_tanf_resource_eligible: true
    wy_tanf_eligible: true

- name: Case 2, fails income eligibility.
  period: 2025-01
  input:
    people:
      person1:
        age: 30
        employment_income_before_lsr: 30_000  # $2,500/month
      person2:
        age: 10
    spm_units:
      spm_unit:
        members: [person1, person2]
        spm_unit_is_married: false
        spm_unit_assets: 2_000
    households:
      household:
        members: [person1, person2]
        state_code: WY
  output:
    # Income: max(2500-600,0) = $1,900 > $1,447 → Income eligible: false
    # Resources: $2,000 < $5,000 → Resources eligible: true
    # Income check fails → Eligible: false
    wy_tanf_income_eligible: false
    wy_tanf_resource_eligible: true
    wy_tanf_eligible: false

- name: Case 3, fails resource eligibility.
  period: 2025-01
  input:
    people:
      person1:
        age: 30
      person2:
        age: 10
    spm_units:
      spm_unit:
        members: [person1, person2]
        spm_unit_is_married: false
        spm_unit_assets: 6_000
    households:
      household:
        members: [person1, person2]
        state_code: WY
  output:
    # Income: $0 < $1,447 → Income eligible: true
    # Resources: $6,000 > $5,000 → Resources eligible: false
    # Resources check fails → Eligible: false
    wy_tanf_income_eligible: true
    wy_tanf_resource_eligible: false
    wy_tanf_eligible: false

- name: Case 4, fails both income and resource eligibility.
  period: 2025-01
  input:
    people:
      person1:
        age: 30
        employment_income_before_lsr: 30_000  # $2,500/month
      person2:
        age: 10
    spm_units:
      spm_unit:
        members: [person1, person2]
        spm_unit_is_married: false
        spm_unit_assets: 8_000
    households:
      household:
        members: [person1, person2]
        state_code: WY
  output:
    # Both checks fail → Eligible: false
    wy_tanf_income_eligible: false
    wy_tanf_resource_eligible: false
    wy_tanf_eligible: false

- name: Case 5, pregnant woman with no children is eligible.
  period: 2025-01
  input:
    people:
      person1:
        age: 25
        is_pregnant: true
    spm_units:
      spm_unit:
        members: [person1]
        spm_unit_is_married: false
        spm_unit_assets: 1_000
    households:
      household:
        members: [person1]
        state_code: WY
  output:
    # Income: $0 < $1,112 → Income eligible: true
    # Resources: $1,000 < $5,000 → Resources eligible: true
    # Pregnant → Demographic eligible: true
    # All checks pass → Eligible: true
    wy_tanf_income_eligible: true
    wy_tanf_resource_eligible: true
    wy_tanf_eligible: true

- name: Case 6, married couple with child barely under income limit.
  period: 2025-01
  input:
    people:
      person1:
        age: 30
        employment_income_before_lsr: 27_600  # $2,300/month
      person2:
        age: 28
      person3:
        age: 8
    spm_units:
      spm_unit:
        members: [person1, person2, person3]
        spm_unit_is_married: true
        spm_unit_assets: 4_000
    households:
      household:
        members: [person1, person2, person3]
        state_code: WY
  output:
    # Countable income: max(2300 - 1200, 0) = $1,100
    # Income limit for size 3: $1,502
    # $1,100 < $1,502 → Income eligible: true
    # Resources: $4,000 < $5,000 → Resources eligible: true
    wy_tanf_income_eligible: true
    wy_tanf_resource_eligible: true
    wy_tanf_eligible: true
