# Wyoming TANF Income Eligibility Tests
# Tests income eligibility: countable income < income limit for household size
# Income Limits by size: 1=$1,112, 2=$1,447, 3=$1,502, 4=$1,502, 5=$1,559, etc.
# Uses STRICT LESS THAN (<) - at threshold = NOT eligible
# Source: Wyoming DFS Table II POWER Income Limits

- name: Case 1, single person below income limit.
  period: 2025-01
  input:
    people:
      person1:
        age: 30
        is_pregnant: true
        employment_income_before_lsr: 12_000  # $1,000/month
    spm_units:
      spm_unit:
        members: [person1]
        spm_unit_is_married: false
    households:
      household:
        members: [person1]
        state_code: WY
  output:
    # Countable income: max(1000 - 600, 0) = $400
    # Income limit for size 1: $1,112
    # $400 < $1,112 -> Eligible
    wy_tanf_income_eligible: true

- name: Case 2, single person above income limit.
  period: 2025-01
  input:
    people:
      person1:
        age: 30
        is_pregnant: true
        employment_income_before_lsr: 24_000  # $2,000/month
    spm_units:
      spm_unit:
        members: [person1]
        spm_unit_is_married: false
    households:
      household:
        members: [person1]
        state_code: WY
  output:
    # Countable income: max(2000 - 600, 0) = $1,400
    # Income limit for size 1: $1,112
    # $1,400 > $1,112 -> Not eligible
    wy_tanf_income_eligible: false

- name: Case 3, family of 2 exactly at income limit.
  period: 2025-01
  input:
    people:
      person1:
        age: 30
        employment_income_before_lsr: 24_564  # $2,047/month
      person2:
        age: 10
    spm_units:
      spm_unit:
        members: [person1, person2]
        spm_unit_is_married: false
    households:
      household:
        members: [person1, person2]
        state_code: WY
  output:
    # Countable income: max(2047 - 600, 0) = $1,447
    # Income limit for size 2: $1,447
    # $1,447 = $1,447 -> Not eligible (must be strictly less than)
    wy_tanf_income_eligible: false

- name: Case 4, family of 2 just below income limit.
  period: 2025-01
  input:
    people:
      person1:
        age: 30
        employment_income_before_lsr: 24_552  # $2,046/month
      person2:
        age: 10
    spm_units:
      spm_unit:
        members: [person1, person2]
        spm_unit_is_married: false
    households:
      household:
        members: [person1, person2]
        state_code: WY
  output:
    # Countable income: max(2046 - 600, 0) = $1,446
    # Income limit for size 2: $1,447
    # $1,446 < $1,447 -> Eligible
    wy_tanf_income_eligible: true

- name: Case 5, family of 3 with no income.
  period: 2025-01
  input:
    people:
      person1:
        age: 30
      person2:
        age: 10
      person3:
        age: 8
    spm_units:
      spm_unit:
        members: [person1, person2, person3]
        spm_unit_is_married: false
    households:
      household:
        members: [person1, person2, person3]
        state_code: WY
  output:
    # Countable income: $0
    # Income limit for size 3: $1,502
    # $0 < $1,502 -> Eligible
    wy_tanf_income_eligible: true

- name: Case 6, married couple with income above limit.
  period: 2025-01
  input:
    people:
      person1:
        age: 30
        employment_income_before_lsr: 36_000  # $3,000/month
      person2:
        age: 28
      person3:
        age: 8
    spm_units:
      spm_unit:
        members: [person1, person2, person3]
        spm_unit_is_married: true
    households:
      household:
        members: [person1, person2, person3]
        state_code: WY
  output:
    # Countable income: max(3000 - 1200, 0) = $1,800
    # Income limit for size 3: $1,502
    # $1,800 > $1,502 -> Not eligible
    wy_tanf_income_eligible: false

- name: Case 7, family of 5 with mixed income.
  period: 2025-01
  input:
    people:
      person1:
        age: 35
        employment_income_before_lsr: 12_000  # $1,000/month
      person2:
        age: 14
      person3:
        age: 12
      person4:
        age: 8
      person5:
        age: 5
    spm_units:
      spm_unit:
        members: [person1, person2, person3, person4, person5]
        spm_unit_is_married: false
    households:
      household:
        members: [person1, person2, person3, person4, person5]
        state_code: WY
  output:
    # Countable income: max(1000 - 600, 0) = $400
    # Income limit for size 5: $1,559
    # $400 < $1,559 -> Eligible
    wy_tanf_income_eligible: true

# =============================================================================
# EDGE CASES
# =============================================================================

- name: Edge case 1, income one dollar above limit for size 1.
  period: 2025-01
  input:
    people:
      person1:
        age: 30
        is_pregnant: true
        employment_income_before_lsr: 20_556  # $1,713/month -> countable = $1,113
    spm_units:
      spm_unit:
        members: [person1]
        spm_unit_is_married: false
    households:
      household:
        members: [person1]
        state_code: WY
  output:
    # Countable income: max(1713 - 600, 0) = $1,113
    # Income limit for size 1: $1,112
    # $1,113 > $1,112 -> Not eligible (one dollar over)
    wy_tanf_income_eligible: false

- name: Edge case 2, income exactly one dollar below limit for size 1.
  period: 2025-01
  input:
    people:
      person1:
        age: 30
        is_pregnant: true
        employment_income_before_lsr: 20_532  # $1,711/month -> countable = $1,111
    spm_units:
      spm_unit:
        members: [person1]
        spm_unit_is_married: false
    households:
      household:
        members: [person1]
        state_code: WY
  output:
    # Countable income: max(1711 - 600, 0) = $1,111
    # Income limit for size 1: $1,112
    # $1,111 < $1,112 -> Eligible (one dollar under)
    wy_tanf_income_eligible: true

- name: Edge case 3, sizes 3 and 4 have same income limit ($1,502).
  period: 2025-01
  input:
    people:
      person1:
        age: 30
        employment_income_before_lsr: 25_212  # $2,101/month -> countable = $1,501
      person2:
        age: 28
      person3:
        age: 10
      person4:
        age: 8
    spm_units:
      spm_unit:
        members: [person1, person2, person3, person4]
        spm_unit_is_married: true
    households:
      household:
        members: [person1, person2, person3, person4]
        state_code: WY
  output:
    # Countable income: max(2101 - 600, 0) = $1,501 (note: single parent, not married)
    # Wait, this is married with child -> $1,200 disregard
    # Countable income: max(2101 - 1200, 0) = $901
    # Income limit for size 4: $1,502 (same as size 3)
    # $901 < $1,502 -> Eligible
    wy_tanf_income_eligible: true

- name: Edge case 4, size 8 household (large family).
  period: 2025-01
  input:
    people:
      person1:
        age: 40
        employment_income_before_lsr: 12_000  # $1,000/month
      person2:
        age: 16
      person3:
        age: 14
      person4:
        age: 12
      person5:
        age: 10
      person6:
        age: 8
      person7:
        age: 6
      person8:
        age: 4
    spm_units:
      spm_unit:
        members: [person1, person2, person3, person4, person5, person6, person7, person8]
        spm_unit_is_married: false
    households:
      household:
        members: [person1, person2, person3, person4, person5, person6, person7, person8]
        state_code: WY
  output:
    # Countable income: max(1000 - 600, 0) = $400
    # Income limit for size 8: $1,615
    # $400 < $1,615 -> Eligible
    wy_tanf_income_eligible: true

- name: Edge case 5, size 12 household (at max_unit_size).
  period: 2025-01
  input:
    people:
      person1:
        age: 45
        employment_income_before_lsr: 12_000  # $1,000/month
      person2:
        age: 17
      person3:
        age: 16
      person4:
        age: 14
      person5:
        age: 12
      person6:
        age: 10
      person7:
        age: 9
      person8:
        age: 8
      person9:
        age: 6
      person10:
        age: 5
      person11:
        age: 3
      person12:
        age: 1
    spm_units:
      spm_unit:
        members: [person1, person2, person3, person4, person5, person6, person7, person8, person9, person10, person11, person12]
        spm_unit_is_married: false
    households:
      household:
        members: [person1, person2, person3, person4, person5, person6, person7, person8, person9, person10, person11, person12]
        state_code: WY
  output:
    # Countable income: max(1000 - 600, 0) = $400
    # Income limit for size 12: $1,839
    # $400 < $1,839 -> Eligible
    wy_tanf_income_eligible: true

- name: Edge case 6, size 13 household (exceeds max_unit_size, capped at 12).
  period: 2025-01
  input:
    people:
      person1:
        age: 45
        employment_income_before_lsr: 12_000  # $1,000/month
      person2:
        age: 17
      person3:
        age: 16
      person4:
        age: 15
      person5:
        age: 14
      person6:
        age: 12
      person7:
        age: 10
      person8:
        age: 9
      person9:
        age: 8
      person10:
        age: 6
      person11:
        age: 5
      person12:
        age: 3
      person13:
        age: 1
    spm_units:
      spm_unit:
        members: [person1, person2, person3, person4, person5, person6, person7, person8, person9, person10, person11, person12, person13]
        spm_unit_is_married: false
    households:
      household:
        members: [person1, person2, person3, person4, person5, person6, person7, person8, person9, person10, person11, person12, person13]
        state_code: WY
  output:
    # Countable income: max(1000 - 600, 0) = $400
    # Size 13 exceeds max_unit_size (12), capped at 12
    # Income limit for size 12: $1,839
    # $400 < $1,839 -> Eligible
    wy_tanf_income_eligible: true

- name: Edge case 7, unearned income only approaching limit.
  period: 2025-01
  input:
    people:
      person1:
        age: 30
        social_security: 17_340  # $1,445/month unearned
      person2:
        age: 10
    spm_units:
      spm_unit:
        members: [person1, person2]
        spm_unit_is_married: false
    households:
      household:
        members: [person1, person2]
        state_code: WY
  output:
    # Countable earned: $0
    # Unearned: $1,445/month
    # Total countable: 0 + 1445 = $1,445
    # Income limit for size 2: $1,447
    # $1,445 < $1,447 -> Eligible (just under)
    wy_tanf_income_eligible: true

- name: Edge case 8, sizes 7 and 8 have same limit ($1,615).
  period: 2025-01
  input:
    people:
      person1:
        age: 40
        employment_income_before_lsr: 26_580  # $2,215/month -> countable = $1,615
      person2:
        age: 15
      person3:
        age: 13
      person4:
        age: 11
      person5:
        age: 9
      person6:
        age: 7
      person7:
        age: 5
    spm_units:
      spm_unit:
        members: [person1, person2, person3, person4, person5, person6, person7]
        spm_unit_is_married: false
    households:
      household:
        members: [person1, person2, person3, person4, person5, person6, person7]
        state_code: WY
  output:
    # Countable income: max(2215 - 600, 0) = $1,615
    # Income limit for size 7: $1,615
    # $1,615 = $1,615 -> Not eligible (exactly at threshold)
    wy_tanf_income_eligible: false

- name: Edge case 9, zero income always eligible.
  period: 2025-01
  input:
    people:
      person1:
        age: 30
      person2:
        age: 10
    spm_units:
      spm_unit:
        members: [person1, person2]
        spm_unit_is_married: false
    households:
      household:
        members: [person1, person2]
        state_code: WY
  output:
    # Countable income: $0
    # Income limit for size 2: $1,447
    # $0 < $1,447 -> Eligible
    wy_tanf_income_eligible: true

- name: Edge case 10, very high income far exceeds limit.
  period: 2025-01
  input:
    people:
      person1:
        age: 30
        employment_income_before_lsr: 120_000  # $10,000/month
      person2:
        age: 10
    spm_units:
      spm_unit:
        members: [person1, person2]
        spm_unit_is_married: false
    households:
      household:
        members: [person1, person2]
        state_code: WY
  output:
    # Countable income: max(10000 - 600, 0) = $9,400
    # Income limit for size 2: $1,447
    # $9,400 >> $1,447 -> Not eligible
    wy_tanf_income_eligible: false
