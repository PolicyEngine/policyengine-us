# Idaho LIHEAP Multi-Household and Complex Family Scenario Tests
# Testing complex household compositions, multi-generational families, and real-world scenarios
# Based on Idaho LIHEAP documentation: "Household includes everyone on the same utility bill"

# Multi-generational Household Tests

- name: Three generation household - grandparents, parents, and children
  period: 2025-01
  input:
    people:
      grandparent1:
        age: 72  # Elderly - priority group
        social_security: 12_000
      grandparent2:
        age: 70  # Elderly - priority group  
        social_security: 10_000
      parent1:
        age: 45
        employment_income: 25_000
      parent2:
        age: 43
        employment_income: 20_000
      child1:
        age: 12
      child2:
        age: 8
      child3:
        age: 4  # Under 6 - priority group
    households:
      household1:
        members: [grandparent1, grandparent2, parent1, parent2, child1, child2, child3]
        state_code: ID
        # 7 person household, total income $67,000
    spm_units:
      spm_unit1:
        members: [grandparent1, grandparent2, parent1, parent2, child1, child2, child3]
  output:
    # Large multi-generational household with multiple priority members
    # Income $67,000 for 7+ people (uses 150% FPL for 8+ per documentation)
    id_liheap_income_eligible: true
    id_liheap_eligible: true
    id_liheap_priority_group: true  # Multiple priority members (elderly + child under 6)

- name: Disabled adult child living with elderly parents
  period: 2025-02
  input:
    people:
      parent1:
        age: 68  # Elderly - priority
        social_security: 15_000
      parent2:
        age: 65  # Elderly - priority
        social_security: 12_000
      adult_child:
        age: 40
        is_disabled: true  # Disabled - priority
    households:
      household1:
        members: [parent1, parent2, adult_child]
        state_code: ID
        # 3 person household, total income $41,400 < $49,044 limit
    spm_units:
      smp_unit1:
        members: [parent1, parent2, adult_child]
  output:
    # Multiple priority groups: elderly parents + disabled adult child
    id_liheap_income_eligible: true
    id_liheap_eligible: true
    id_liheap_priority_group: true

# Single Parent Households

- name: Single mother with multiple young children - high priority
  period: 2025-01
  input:
    people:
      mother:
        age: 28
        employment_income: 18_000  # Low income single parent
      child1:
        age: 5  # Under 6 - priority
      child2:
        age: 3  # Under 6 - priority  
      child3:
        age: 1  # Under 6 - priority
    households:
      household1:
        members: [mother, child1, child2, child3]
        state_code: ID
        snap: 400  # Also receives SNAP - categorically eligible
    spm_units:
      spm_unit1:
        members: [mother, child1, child2, child3]
  output:
    # Single parent with multiple priority children + SNAP participation
    id_liheap_categorically_eligible: true  # SNAP participation
    id_liheap_income_eligible: true  # Low income
    id_liheap_eligible: true
    id_liheap_priority_group: true  # Multiple children under 6

- name: Single father with teenage children - no priority
  period: 2025-01
  input:
    people:
      father:
        age: 42
        employment_income: 35_000
      child1:
        age: 16
      child2:
        age: 14
      child3:
        age: 12
    households:
      household1:
        members: [father, child1, child2, child3]
        state_code: ID
        # 4 person household, income $35,000 < $58,392 limit
    spm_units:
      spm_unit1:
        members: [father, child1, child2, child3]
  output:
    # Income eligible but no priority group members
    id_liheap_income_eligible: true
    id_liheap_eligible: true
    id_liheap_priority_group: false  # No elderly, disabled, or children under 6

# Mixed Family Situations

- name: Blended family with stepchildren and biological children
  period: 2025-01
  input:
    people:
      stepparent1:
        age: 38
        employment_income: 22_000
      stepparent2:
        age: 36
        employment_income: 18_000
      biological_child1:
        age: 8
      biological_child2:
        age: 5  # Under 6 - priority
      stepchild1:
        age: 10
      stepchild2:
        age: 7
    households:
      household1:
        members: [stepparent1, stepparent2, biological_child1, biological_child2, stepchild1, stepchild2]
        state_code: ID
        # 6 person household, income $40,000 < $77,076 limit
    spm_units:
      spm_unit1:
        members: [stepparent1, stepparent2, biological_child1, biological_child2, stepchild1, stepchild2]
  output:
    # Blended family eligible with one priority child
    id_liheap_income_eligible: true
    id_liheap_eligible: true
    id_liheap_priority_group: true  # One child under 6

- name: Foster family with foster children counted in household
  period: 2025-01
  input:
    people:
      foster_parent1:
        age: 45
        employment_income: 30_000
      foster_parent2:
        age: 43
        employment_income: 25_000
      foster_child1:
        age: 9
      foster_child2:
        age: 6
      foster_child3:
        age: 4  # Under 6 - priority
      biological_child:
        age: 12
    households:
      household1:
        members: [foster_parent1, foster_parent2, foster_child1, foster_child2, foster_child3, biological_child]
        state_code: ID
        # 6 person household, income $55,000 < $77,076 limit
    spm_units:
      smp_unit1:
        members: [foster_parent1, foster_parent2, foster_child1, foster_child2, foster_child3, biological_child]
  output:
    # Foster family eligible, foster children count toward household size
    id_liheap_income_eligible: true
    id_liheap_eligible: true
    id_liheap_priority_group: true  # Foster child under 6

# Adult Children Living at Home

- name: Young adult children living with parents - large household
  period: 2025-01
  input:
    people:
      parent1:
        age: 52
        employment_income: 20_000
      parent2:
        age: 50
        employment_income: 15_000
      adult_child1:
        age: 22
        employment_income: 12_000  # Part-time work
      adult_child2:
        age: 20
        employment_income: 8_000   # Part-time work
      teen_child1:
        age: 17
      teen_child2:
        age: 15
    households:
      household1:
        members: [parent1, parent2, adult_child1, adult_child2, teen_child1, teen_child2]
        state_code: ID
        # 6 person household, total income $55,000 < $77,076 limit
    spm_units:
      spm_unit1:
        members: [parent1, parent2, adult_child1, adult_child2, teen_child1, teen_child2]
  output:
    # Large family with adult children contributing income
    id_liheap_income_eligible: true
    id_liheap_eligible: true
    id_liheap_priority_group: false  # No priority group members

# Special Circumstances

- name: Household with non-citizen members - mixed status family
  period: 2025-01
  input:
    people:
      us_citizen_parent:
        age: 40
        employment_income: 30_000
        is_us_citizen: true  # US citizen
      noncitizen_parent:
        age: 38
        employment_income: 15_000
        is_us_citizen: false  # Non-citizen
      us_citizen_child1:
        age: 8
        is_us_citizen: true  # US citizen child
      us_citizen_child2:
        age: 3  # Under 6 - priority
        is_us_citizen: true  # US citizen child
    households:
      household1:
        members: [us_citizen_parent, noncitizen_parent, us_citizen_child1, us_citizen_child2]
        state_code: ID
        # 4 person household, income $45,000 < $58,392 limit
    spm_units:
      spm_unit1:
        members: [us_citizen_parent, noncitizen_parent, us_citizen_child1, us_citizen_child2]
  output:
    # Mixed status family - at least one member is US citizen (requirement met)
    id_liheap_income_eligible: true
    id_liheap_eligible: true  # Has US citizen members
    id_liheap_priority_group: true  # Child under 6

- name: Household with seasonal/irregular income - agricultural worker
  period: 2025-01
  input:
    people:
      seasonal_worker:
        age: 35
        employment_income: 15_000  # Seasonal agricultural work
      spouse:
        age: 33
        employment_income: 8_000   # Part-time work
      child1:
        age: 10
      child2:
        age: 7
      child3:
        age: 4  # Under 6 - priority
    households:
      household1:
        members: [seasonal_worker, spouse, child1, child2, child3]
        state_code: ID
        # 5 person household, income $23,000 < $67,728 limit
    spm_units:
      spm_unit1:
        members: [seasonal_worker, spouse, child1, child2, child3]
  output:
    # Low income agricultural family eligible with priority child
    id_liheap_income_eligible: true
    id_liheap_eligible: true
    id_liheap_priority_group: true

# Crisis Situations with Complex Families

- name: Large family in crisis - utility shutoff imminent
  period: 2025-07  # Summer crisis situation
  input:
    people:
      parent1:
        age: 42
        employment_income: 28_000
      parent2:
        age: 40
        employment_income: 15_000
      child1:
        age: 14
      child2:
        age: 11
      child3:
        age: 8
      child4:
        age: 5  # Under 6 - priority
      elderly_grandparent:
        age: 75  # Elderly - priority
        social_security: 8_000
    households:
      household1:
        members: [parent1, parent2, child1, child2, child3, child4, elderly_grandparent]
        state_code: ID
        # 7 person household with crisis need
    spm_units:
      spm_unit1:
        members: [parent1, parent2, child1, child2, child3, child4, elderly_grandparent]
  output:
    # Large family with multiple priority members in crisis
    id_liheap_eligible: true
    id_liheap_priority_group: true  # Child under 6 + elderly
    id_liheap_crisis_eligible: true  # Crisis situation in summer

- name: Weatherization eligible large family - homeowner with efficiency needs
  period: 2025-05
  input:
    people:
      homeowner:
        age: 55
        employment_income: 35_000
      spouse:
        age: 52
        employment_income: 25_000
      adult_child:
        age: 25
        employment_income: 15_000
      grandchild1:
        age: 3  # Under 6 - priority
      grandchild2:
        age: 6
    households:
      household1:
        members: [homeowner, spouse, adult_child, grandchild1, grandchild2]
        state_code: ID
        # 5 person household, income $75,000 (need to check if under 200% FPL for 5)
    spm_units:
      smp_unit1:
        members: [homeowner, spouse, adult_child, grandchild1, grandchild2]
  output:
    # Multi-generational homeowner family for weatherization
    # 200% FPL for 5 people is approximately $75,000+ in 2025
    id_liheap_weatherization_income_eligible: true  # Right at or under 200% FPL
    id_liheap_weatherization_eligible: true
    id_liheap_priority_group: true  # Child under 6

# Income Verification Scenarios

- name: Self-employed household with variable income
  period: 2025-01
  input:
    people:
      self_employed:
        age: 48
        self_employment_income: 25_000  # Variable small business income
      spouse:
        age: 46
        employment_income: 20_000
      child1:
        age: 13
      child2:
        age: 9
    households:
      household1:
        members: [self_employed, spouse, child1, child2]
        state_code: ID
        # 4 person household, income $45,000 < $58,392 limit
    spm_units:
      spm_unit1:
        members: [self_employed, spouse, child1, child2]
  output:
    # Self-employed family with mixed income types
    id_liheap_income_eligible: true
    id_liheap_eligible: true
    id_liheap_priority_group: false  # No priority group members

- name: Retired couple with pension and social security
  period: 2025-01
  input:
    people:
      retiree1:
        age: 67  # Elderly - priority
        social_security: 16_000
        pension_income: 12_000
      retiree2:
        age: 64  # Elderly - priority
        social_security: 14_000
        # Total income $42,000 > $39,708 limit for 2 people but categorically eligible if SSI
    households:
      household1:
        members: [retiree1, retiree2]
        state_code: ID
        # 2 person household
    spm_units:
      smp_unit1:
        members: [retiree1, retiree2]
  output:
    # Elderly couple with moderate retirement income
    # Income $42,000 > $39,708 limit for 2 people - not income eligible
    id_liheap_income_eligible: false  # Above income threshold
    id_liheap_categorically_eligible: false  # Social Security is not SSI
    id_liheap_eligible: false  # Not eligible despite being elderly
