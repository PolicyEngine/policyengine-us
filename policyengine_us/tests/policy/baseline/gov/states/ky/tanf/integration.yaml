# Kentucky TANF (K-TAP) Integration Tests
# Per 921 KAR 2:016 - Standards of need and amount for KTAP
# Tests the complete benefit calculation pipeline
# Note: Tests use YEAR period; MONTH variables are automatically annualized
#
# Key Formulas (monthly):
#   Countable Earned = max(sum_gross_earned - $175, 0)
#   Countable Unearned = max(gross_unearned - min(child_support, $50), 0)
#   Countable Income = countable_earned + countable_unearned
#   Benefit = min(0.55 * max(need_standard - countable_income, 0), payment_standard)

- name: Case 1, single parent with two children, no income.
  period: 2024
  input:
    people:
      person1:
        age: 30
        employment_income: 0
        self_employment_income: 0
      person2:
        age: 8
      person3:
        age: 5
    spm_units:
      spm_unit:
        members: [person1, person2, person3]
        spm_unit_assets: 0
    households:
      household:
        members: [person1, person2, person3]
        state_code: KY
  output:
    # Family size 3
    # Monthly values annualized (* 12)
    ky_tanf_need_standard: 631 * 12
    ky_tanf_payment_standard: 524 * 12
    # Earned: max($0 - $175, 0) = $0/month
    ky_tanf_countable_earned_income: 0
    ky_tanf_countable_unearned_income: 0
    ky_tanf_countable_income: 0
    # Income eligibility: $0 < $1,169 limit
    ky_tanf_income_eligible: true
    # Resource eligibility: $0 < $10,000 limit
    ky_tanf_resource_eligible: true
    ky_tanf_eligible: true
    # Monthly benefit: min(0.55 * $631, $524) = min($347.05, $524) = $347.05
    # Annual benefit: $347.05 * 12 = $4164.60
    ky_tanf: 347.05 * 12

- name: Case 2, adults only household, no eligible children.
  period: 2024
  input:
    people:
      person1:
        age: 45
        employment_income: 0
      person2:
        age: 42
        employment_income: 0
    spm_units:
      spm_unit:
        members: [person1, person2]
        spm_unit_assets: 0
    households:
      household:
        members: [person1, person2]
        state_code: KY
  output:
    # Family size 2
    ky_tanf_need_standard: 552 * 12
    ky_tanf_payment_standard: 450 * 12
    ky_tanf_countable_earned_income: 0
    ky_tanf_countable_unearned_income: 0
    ky_tanf_countable_income: 0
    # Income eligible but demographically ineligible (no children)
    ky_tanf_income_eligible: true
    ky_tanf_resource_eligible: true
    ky_tanf_eligible: false
    ky_tanf: 0
