# Unit tests for Oklahoma TANF countable earned income
# OAC 340:10-3-33: $120 work expense + 50% disregard
# https://oklahoma.gov/okdhs/library/policy/current/oac-340/chapter-10/subchapter-3/parts-3/earned-income-disregard.html

- name: No earned income
  period: 2024-01
  input:
    people:
      adult:
        age: 30
        employment_income_before_lsr: 0
      child:
        age: 5
    spm_units:
      spm_unit:
        members: [adult, child]
    households:
      household:
        members: [adult, child]
        state_code: OK
  output:
    ok_tanf_countable_earned_income: 0

- name: Earned income with work expense and 50% disregard
  period: 2024-01
  input:
    people:
      adult:
        age: 30
        employment_income_before_lsr: 6_000  # $500/month
      child:
        age: 5
    spm_units:
      spm_unit:
        members: [adult, child]
    households:
      household:
        members: [adult, child]
        state_code: OK
  output:
    # Monthly gross earned: $500
    # Work expense: $120
    # After work expense: $500 - $120 = $380
    # 50% disregard: $380 * 0.50 = $190
    # Countable earned: $190
    ok_tanf_countable_earned_income: 190

- name: Earned income below work expense
  period: 2024-01
  input:
    people:
      adult:
        age: 30
        employment_income_before_lsr: 1_200  # $100/month
      child:
        age: 5
    spm_units:
      spm_unit:
        members: [adult, child]
    households:
      household:
        members: [adult, child]
        state_code: OK
  output:
    # Monthly gross earned: $100
    # Work expense: $120
    # After work expense: max($100 - $120, 0) = $0
    # Countable earned: $0
    ok_tanf_countable_earned_income: 0

- name: Higher earned income
  period: 2024-01
  input:
    people:
      adult:
        age: 30
        employment_income_before_lsr: 12_000  # $1,000/month
      child:
        age: 5
    spm_units:
      spm_unit:
        members: [adult, child]
    households:
      household:
        members: [adult, child]
        state_code: OK
  output:
    # Monthly gross earned: $1,000
    # Work expense: $120
    # After work expense: $1,000 - $120 = $880
    # 50% disregard: $880 * 0.50 = $440
    # Countable earned: $440
    ok_tanf_countable_earned_income: 440
