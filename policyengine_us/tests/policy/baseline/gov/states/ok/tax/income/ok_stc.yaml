# Oklahoma Sales Tax Relief Credit Tests (Form 538-S)
# Credit amount: $40 per exemption (each household member)
# Income limits:
#   - Elderly (65+), disabled, or has dependents: $50,000
#   - All other filers: $20,000
# TANF recipients are excluded (TANF includes sales tax relief)

- name: OK STC - 2021 - elderly with dependents
  period: 2021
  input:
    filing_status: JOINT
    greater_age_head_spouse: 65
    tax_unit_dependents: 2
    tax_unit_size: 4
    ok_gross_income: 21_000
    state_code: OK
  output:
    # Elderly (65+) qualifies for $50,000 limit
    # Income $21,000 < $50,000 limit
    # 4 exemptions * $40 = $160
    ok_stc: 4 * 40

- name: OK STC - 2021 - non-elderly over limit
  period: 2021
  input:
    filing_status: JOINT
    greater_age_head_spouse: 60
    tax_unit_dependents: 2
    tax_unit_size: 4
    ok_gross_income: 51_000
    state_code: OK
  output:
    # Age 60 (not elderly), but has dependents, so $50,000 limit applies
    # However, income $51,000 > $50,000 = no credit
    ok_stc: 0

- name: OK STC - 2021 - TANF recipient excluded
  period: 2021
  input:
    filing_status: HEAD_OF_HOUSEHOLD
    greater_age_head_spouse: 30
    tax_unit_dependents: 1
    tax_unit_size: 2
    ok_gross_income: 18_000
    ok_tanf: 2_000
    state_code: OK
  output:
    # TANF recipients excluded (TANF includes sales tax relief)
    ok_stc: 0

# 2025 Sales Tax Credit Tests

- name: OK STC - 2025 - single under $20k limit
  period: 2025
  input:
    filing_status: SINGLE
    greater_age_head_spouse: 35
    tax_unit_dependents: 0
    tax_unit_size: 1
    ok_gross_income: 15_000
    state_code: OK
  output:
    # Single, no dependents, not elderly/disabled
    # Uses $20,000 income limit
    # Income $15,000 < $20,000
    # 1 exemption * $40 = $40
    ok_stc: 40

- name: OK STC - 2025 - single over $20k limit
  period: 2025
  input:
    filing_status: SINGLE
    greater_age_head_spouse: 40
    tax_unit_dependents: 0
    tax_unit_size: 1
    ok_gross_income: 25_000
    state_code: OK
  output:
    # Single, no dependents, not elderly/disabled
    # Uses $20,000 income limit
    # Income $25,000 > $20,000 = no credit
    ok_stc: 0

- name: OK STC - 2025 - elderly joint under $50k limit
  period: 2025
  input:
    filing_status: JOINT
    greater_age_head_spouse: 68
    tax_unit_dependents: 0
    tax_unit_size: 2
    ok_gross_income: 35_000
    state_code: OK
  output:
    # Elderly (68), uses $50,000 limit
    # Income $35,000 < $50,000
    # 2 exemptions * $40 = $80
    ok_stc: 80

- name: OK STC - 2025 - family with dependents under $50k limit
  period: 2025
  input:
    filing_status: JOINT
    greater_age_head_spouse: 45
    tax_unit_dependents: 3
    tax_unit_size: 5
    ok_gross_income: 45_000
    state_code: OK
  output:
    # Has dependents, uses $50,000 limit
    # Income $45,000 < $50,000
    # 5 exemptions * $40 = $200
    ok_stc: 200

- name: OK STC - 2025 - disabled qualifies for higher limit
  period: 2025
  input:
    people:
      person1:
        is_tax_unit_head: true
        is_disabled: true
        age: 50
        employment_income: 30_000
    tax_units:
      tax_unit:
        members: [person1]
    households:
      household:
        members: [person1]
        state_code: OK
  output:
    # Disabled qualifies for $50,000 limit
    # Income $30,000 < $50,000
    # 1 exemption * $40 = $40
    ok_stc: 40

- name: OK STC - 2025 - exactly at income limit
  period: 2025
  input:
    filing_status: SINGLE
    greater_age_head_spouse: 40
    tax_unit_dependents: 0
    tax_unit_size: 1
    ok_gross_income: 20_000
    state_code: OK
  output:
    # Exactly at $20,000 limit = eligible
    # 1 exemption * $40 = $40
    ok_stc: 40
