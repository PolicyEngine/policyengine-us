# Tests for in_tanf_countable_income_eligible
# Uses eligibility disregards: $90/earner, $30/unit, 1/3 of remainder
# Compares to standard of need (initial) or FPL (continuing)

- name: Family of 3 with zero income - eligible
  period: 2024-01
  input:
    people:
      person1:
        age: 30
        tanf_gross_earned_income: 0
      person2:
        age: 10
      person3:
        age: 8
    spm_units:
      spm_unit:
        members: [person1, person2, person3]
    households:
      household:
        members: [person1, person2, person3]
        state_code: IN
  output:
    in_tanf_countable_income_for_eligibility: [0, 0, 0]
    in_tanf_countable_income_eligible: [true, true, true]
    # Countable income ($0) < standard of need ($320) → eligible

- name: Family of 3 with low earned income - eligible
  period: 2024-01
  input:
    people:
      person1:
        age: 30
        tanf_gross_earned_income: 300
      person2:
        age: 10
      person3:
        age: 8
    spm_units:
      spm_unit:
        members: [person1, person2, person3]
    households:
      household:
        members: [person1, person2, person3]
        state_code: IN
  output:
    in_tanf_countable_earned_income_for_eligibility: [120.6, 120.6, 120.6]
    # $300 - $90 (work expense) = $210
    # $210 - $30 (unit disregard) = $180
    # $180 * (1 - 0.33) = $120.60
    in_tanf_countable_income_for_eligibility: [120.6, 120.6, 120.6]
    in_tanf_countable_income_eligible: [true, true, true]
    # Countable ($120.60) < standard of need ($320) → eligible

- name: Family of 3 with moderate earned income - not eligible
  period: 2024-01
  input:
    people:
      person1:
        age: 30
        tanf_gross_earned_income: 600
      person2:
        age: 10
      person3:
        age: 8
    spm_units:
      spm_unit:
        members: [person1, person2, person3]
    households:
      household:
        members: [person1, person2, person3]
        state_code: IN
  output:
    in_tanf_countable_earned_income_for_eligibility: [321.6, 321.6, 321.6]
    # $600 - $90 = $510
    # $510 - $30 = $480
    # $480 * 0.67 = $321.60
    in_tanf_countable_income_for_eligibility: [321.6, 321.6, 321.6]
    in_tanf_countable_income_eligible: [false, false, false]
    # Countable ($321.60) >= standard of need ($320) → not eligible

- name: Family of 2 with earned income at threshold - not eligible
  period: 2024-01
  input:
    people:
      person1:
        age: 30
        tanf_gross_earned_income: 500
      person2:
        age: 10
    spm_units:
      spm_unit:
        members: [person1, person2]
    households:
      household:
        members: [person1, person2]
        state_code: IN
  output:
    in_tanf_countable_earned_income_for_eligibility: [254.6, 254.6]
    # $500 - $90 = $410
    # $410 - $30 = $380
    # $380 * 0.67 = $254.60
    in_tanf_countable_income_for_eligibility: [254.6, 254.6]
    in_tanf_countable_income_eligible: [true, true]
    # Countable ($254.60) < standard of need ($255) → eligible

- name: Two earners - each gets $90 disregard
  period: 2024-01
  input:
    people:
      person1:
        age: 30
        tanf_gross_earned_income: 200
      person2:
        age: 28
        tanf_gross_earned_income: 200
      person3:
        age: 10
    spm_units:
      spm_unit:
        members: [person1, person2, person3]
    households:
      household:
        members: [person1, person2, person3]
        state_code: IN
  output:
    in_tanf_countable_earned_income_for_eligibility: [127.3, 127.3, 127.3]
    # Person1: $200 - $90 = $110
    # Person2: $200 - $90 = $110
    # Unit total: $220
    # $220 - $30 = $190
    # $190 * 0.67 = $127.30
    in_tanf_countable_income_for_eligibility: [127.3, 127.3, 127.3]
    in_tanf_countable_income_eligible: [true, true, true]
    # Countable ($127.30) < standard of need ($320) → eligible

- name: Continuing eligibility uses FPL threshold
  period: 2024-01
  input:
    people:
      person1:
        age: 30
        tanf_gross_earned_income: 1_000
      person2:
        age: 10
      person3:
        age: 8
    spm_units:
      spm_unit:
        members: [person1, person2, person3]
        is_tanf_enrolled: true
    households:
      household:
        members: [person1, person2, person3]
        state_code: IN
  output:
    in_tanf_countable_earned_income_for_eligibility: [589.6, 589.6, 589.6]
    # $1000 - $90 = $910
    # $910 - $30 = $880
    # $880 * 0.67 = $589.60
    in_tanf_countable_income_for_eligibility: [589.6, 589.6, 589.6]
    in_tanf_countable_income_eligible: [true, true, true]
    # Countable ($589.60) < 100% FPL for 3 (~$1,988/mo) → eligible
